! Copyright (c) 2007-2018 Alberto Otero de la Roza <aoterodelaroza@gmail.com>,
! Ángel Martín Pendás <angel@fluor.quimica.uniovi.es> and Víctor Luaña
! <victor@fluor.quimica.uniovi.es>.
!
! critic2 is free software: you can redistribute it and/or modify
! it under the terms of the GNU General Public License as published by
! the Free Software Foundation, either version 3 of the License, or (at
! your option) any later version.
!
! critic2 is distributed in the hope that it will be useful,
! but WITHOUT ANY WARRANTY; without even the implied warranty of
! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
! GNU General Public License for more details.
!
! You should have received a copy of the GNU General Public License
! along with this program.  If not, see <http://www.gnu.org/licenses/>.

submodule (graphics) proc
  implicit none

  !xx! private procedures
  ! subroutine graphics_init()
  ! subroutine obj_open(g)
  ! subroutine obj_close(g)
  ! subroutine obj_ball(g,x,rgb,r)
  ! subroutine obj_polygon(g,x,rgb)
  ! subroutine obj_stick(g,x1,x2,rgb,r)
  ! subroutine obj_surf(g,srf,fsurf)
  ! subroutine obj_triangulation(g,srf,nv,xv,nf,if,xrho)
  ! function register_texture(g,rgb) result(imtl)
  ! subroutine ply_open(g)
  ! subroutine ply_close(g)
  ! subroutine ply_ball(g,x,rgb,r)
  ! subroutine ply_polygon(g,x,rgb)
  ! subroutine ply_stick(g,x1,x2,rgb,r)
  ! subroutine ply_surf(g,srf,fsurf)
  ! subroutine ply_triangulation(g,srf,nv,xv,nf,if,xrho)
  ! subroutine off_open(g)
  ! subroutine off_close(g)
  ! subroutine off_ball(g,x,rgb,r)
  ! subroutine off_polygon(g,x,rgb)
  ! subroutine off_stick(g,x1,x2,rgb,r)
  ! subroutine off_surf(g,srf,fsurf)
  ! subroutine off_triangulation(g,srf,nv,xv,nf,if,xrho)

  ! graphics database
  logical :: isinit = .false.

  ! icosahedron models
  integer :: nvsph(0:4), nfsph(0:4)
  real*8 :: vsph(3,642,0:4)
  integer :: fsph(3,1280,0:4)

  ! cylinder models
  integer :: nvcyl(0:1), nfcyl(0:1)
  real*8 :: vcyl(3,34,0:1)
  integer :: fcyl(3,64,0:1)

  ! formats
  integer, parameter :: ifmt_unk = 0
  integer, parameter :: ifmt_obj = 1
  integer, parameter :: ifmt_ply = 2
  integer, parameter :: ifmt_off = 3

contains

  !> Open a graphics file (file) with format fmt. Returns the logical
  !> unit and (in obj files) the mtl file.
  module subroutine graphics_open(g,fmt,file)
    use tools_io, only: equal, lower
    class(grhandle), intent(inout) :: g
    character*3, intent(in) :: fmt
    character*(*), intent(in) :: file

    character*3 :: fmt0

    if (.not.isinit) then
       !$omp critical (initgraph)
       call graphics_init()
       !$omp end critical (initgraph)
    end if

    fmt0 = lower(fmt)
    if (.not.(equal(fmt0,"obj") .or. equal(fmt0,"ply") .or. equal(fmt0,"off"))) &
       return
    g%file = adjustl(file)

    if (equal(fmt0,"obj")) then
       g%fmt = ifmt_obj
       call obj_open(g)
    elseif (equal(fmt0,"ply")) then
       g%fmt = ifmt_ply
       call ply_open(g)
    elseif (equal(fmt0,"off")) then
       g%fmt = ifmt_off
       call off_open(g)
    end if

  end subroutine graphics_open

  !> Open a graphics file (lu, lumtl) with format fmt.
  module subroutine graphics_close(g)
    use tools_io, only: equal
    class(grhandle), intent(inout) :: g

    if (g%fmt == ifmt_obj) then
       call obj_close(g)
    elseif (g%fmt == ifmt_ply) then
       call ply_close(g)
    elseif (g%fmt == ifmt_off) then
       call off_close(g)
    end if
    g%lu = 0
    g%lumtl = 0
    g%fmt = ifmt_unk
    g%file = ""
    g%nball = 0
    g%nstick = 0
    g%nsurf = 0
    g%npoly = 0
    g%nmtl = 0
    g%nv = 0
    g%nf = 0
    if (allocated(g%mtlrgb)) deallocate(g%mtlrgb)

  end subroutine graphics_close

  !> Write a ball to a graphics file. The center is at x (Cartesian)
  !> and the radius is r. rgb is the color.
  module subroutine graphics_ball(g,x,rgb,r)
    use tools_io, only: equal
    class(grhandle), intent(inout) :: g
    real*8, intent(in) :: x(3)
    integer, intent(in) :: rgb(3)
    real*8, intent(in) :: r

    if (g%fmt == ifmt_obj) then
       call obj_ball(g,x,rgb,r)
    elseif (g%fmt == ifmt_ply) then
       call ply_ball(g,x,rgb,r)
    elseif (g%fmt == ifmt_off) then
       call off_ball(g,x,rgb,r)
    end if

  end subroutine graphics_ball

  !> Write a polygon to a graphics file.  The vertices are in x, and
  !> are assumed to be consecutive. rgb is the color.
  module subroutine graphics_polygon(g,x,rgb)
    use tools_io, only: equal
    class(grhandle), intent(inout) :: g
    real*8, intent(in) :: x(:,:)
    integer, intent(in) :: rgb(3)

    if (g%fmt == ifmt_obj) then
       call obj_polygon(g,x,rgb)
    elseif (g%fmt == ifmt_ply) then
       call ply_polygon(g,x,rgb)
    elseif (g%fmt == ifmt_off) then
       call off_polygon(g,x,rgb)
    end if

  end subroutine graphics_polygon

  !> Write a stick to a graphics file.  The vertices are in x, and are
  !> assumed to be consecutive. rgb is the color.
  module subroutine graphics_stick(g,x1,x2,rgb,r)
    use tools_io, only: equal
    class(grhandle), intent(inout) :: g
    real*8, intent(in) :: x1(3), x2(3)
    integer, intent(in) :: rgb(3)
    real*8, intent(in) :: r

    if (g%fmt == ifmt_obj) then
       call obj_stick(g,x1,x2,rgb,r)
    elseif (g%fmt == ifmt_ply) then
       call ply_stick(g,x1,x2,rgb,r)
    elseif (g%fmt == ifmt_off) then
       call off_stick(g,x1,x2,rgb,r)
    end if

  end subroutine graphics_stick

  !> Write a surface (srf with colors fsurf) to graphics file.
  module subroutine graphics_surf(g,srf,fsurf)
    use tools_io, only: equal
    use surface, only: minisurf
    class(grhandle), intent(inout) :: g
    type(minisurf), intent(in) :: srf
    real*8, intent(in), optional :: fsurf(:)

    if (g%fmt == ifmt_obj) then
       call obj_surf(g,srf,fsurf)
    elseif (g%fmt == ifmt_ply) then
       call ply_surf(g,srf,fsurf)
    elseif (g%fmt == ifmt_off) then
       call off_surf(g,srf,fsurf)
    end if

  end subroutine graphics_surf

  !> Write a surface from its triangulation to a graphics file.
  module subroutine graphics_triangulation(g,nv,xv,nf,if,xrho)
    class(grhandle), intent(inout) :: g
    integer, intent(in) :: nv, nf
    real*8, intent(in) :: xv(3,nv)
    integer, intent(in) :: if(3,nf)
    real*8, intent(in), optional :: xrho(nv)

    if (g%fmt == ifmt_obj) then
       call obj_triangulation(g,nv,xv,nf,if,xrho)
    elseif (g%fmt == ifmt_ply) then
       call ply_triangulation(g,nv,xv,nf,if,xrho)
    elseif (g%fmt == ifmt_off) then
       call off_triangulation(g,nv,xv,nf,if,xrho)
    end if

  end subroutine graphics_triangulation

  !xx! private procedures

  ! initialize the icosahedron vertices and faces
  subroutine graphics_init()

    ! fill the icosahedron models
    vsph = 0d0
    fsph = 0

    ! lvl 0 -- a tetrahedron
    nvsph(0) = 4
    vsph(1:3,1:4,0) = reshape((/&
        0.57735d0,  0.57735d0,  0.57735d0,&
       -0.57735d0, -0.57735d0,  0.57735d0,&
       -0.57735d0,  0.57735d0, -0.57735d0,&
        0.57735d0, -0.57735d0, -0.57735d0/),(/3,4/))

    nfsph(0) = 4
    fsph(1:3,1:4,0) = reshape((/&
        1, 2, 3,&
        1, 2, 4,&
        1, 3, 4,&
        2, 3, 4/),(/3,4/))

    ! lvl 1 -- an icosahedron
    nvsph(1) = 12
    vsph(1:3,1:12,1) = reshape((/&
        0.85065d0,   0.00000d0,   0.52573d0,&
        0.85065d0,   0.00000d0,  -0.52573d0,&
       -0.85065d0,   0.00000d0,   0.52573d0,&
       -0.85065d0,   0.00000d0,  -0.52573d0,&
        0.00000d0,   0.52573d0,   0.85065d0,&
        0.00000d0,  -0.52573d0,   0.85065d0,&
        0.00000d0,   0.52573d0,  -0.85065d0,&
        0.00000d0,  -0.52573d0,  -0.85065d0,&
        0.52573d0,   0.85065d0,   0.00000d0,&
       -0.52573d0,   0.85065d0,   0.00000d0,&
        0.52573d0,  -0.85065d0,   0.00000d0,&
       -0.52573d0,  -0.85065d0,   0.00000d0/),(/3,12/))

    nfsph(1) = 20
    fsph(1:3,1:20,1) = reshape((/&
        1,  9,  5,&
       10,  9,  7,&
        3,  5, 10,&
        9, 10,  5,&
        3, 10,  4,&
       10,  7,  4,&
        1, 11,  2,&
        9,  1,  2,&
        7,  9,  2,&
       12,  3,  4,&
        6,  1,  5,&
       11,  1,  6,&
       12, 11,  6,&
        5,  3,  6,&
        6,  3, 12,&
        8,  7,  2,&
        8,  2, 11,&
        8, 11, 12,&
        4,  7,  8,&
       12,  4,  8/),(/3,20/))

    ! lvl 2 icosphere
    nvsph(2) = 42
    vsph(1:3,1:42,2) = reshape((/&
       -5.2573114634d-01, 0.0000000000d+00, 8.5065084696d-01,&
       5.2573114634d-01, 0.0000000000d+00, 8.5065084696d-01,&
       -5.2573114634d-01, 0.0000000000d+00, -8.5065084696d-01,&
       5.2573114634d-01, 0.0000000000d+00, -8.5065084696d-01,&
       0.0000000000d+00, 8.5065084696d-01, 5.2573114634d-01,&
       0.0000000000d+00, 8.5065084696d-01, -5.2573114634d-01,&
       0.0000000000d+00, -8.5065084696d-01, 5.2573114634d-01,&
       0.0000000000d+00, -8.5065084696d-01, -5.2573114634d-01,&
       8.5065084696d-01, 5.2573114634d-01, 0.0000000000d+00,&
       -8.5065084696d-01, 5.2573114634d-01, 0.0000000000d+00,&
       8.5065084696d-01, -5.2573114634d-01, 0.0000000000d+00,&
       -8.5065084696d-01, -5.2573114634d-01, 0.0000000000d+00,&
       0.0000000000d+00, 0.0000000000d+00, 1.0000000000d+00,&
       -3.0901700258d-01, 5.0000000000d-01, 8.0901700258d-01,&
       3.0901700258d-01, 5.0000000000d-01, 8.0901700258d-01,&
       -8.0901700258d-01, 3.0901700258d-01, 5.0000000000d-01,&
       -5.0000000000d-01, 8.0901700258d-01, 3.0901700258d-01,&
       -5.0000000000d-01, 8.0901700258d-01, -3.0901700258d-01,&
       0.0000000000d+00, 1.0000000000d+00, 0.0000000000d+00,&
       5.0000000000d-01, 8.0901700258d-01, 3.0901700258d-01,&
       5.0000000000d-01, 8.0901700258d-01, -3.0901700258d-01,&
       8.0901700258d-01, 3.0901700258d-01, 5.0000000000d-01,&
       1.0000000000d+00, 0.0000000000d+00, 0.0000000000d+00,&
       8.0901700258d-01, -3.0901700258d-01, 5.0000000000d-01,&
       8.0901700258d-01, 3.0901700258d-01, -5.0000000000d-01,&
       8.0901700258d-01, -3.0901700258d-01, -5.0000000000d-01,&
       3.0901700258d-01, 5.0000000000d-01, -8.0901700258d-01,&
       -3.0901700258d-01, 5.0000000000d-01, -8.0901700258d-01,&
       0.0000000000d+00, 0.0000000000d+00, -1.0000000000d+00,&
       -3.0901700258d-01, -5.0000000000d-01, -8.0901700258d-01,&
       3.0901700258d-01, -5.0000000000d-01, -8.0901700258d-01,&
       5.0000000000d-01, -8.0901700258d-01, -3.0901700258d-01,&
       0.0000000000d+00, -1.0000000000d+00, 0.0000000000d+00,&
       5.0000000000d-01, -8.0901700258d-01, 3.0901700258d-01,&
       -5.0000000000d-01, -8.0901700258d-01, -3.0901700258d-01,&
       -5.0000000000d-01, -8.0901700258d-01, 3.0901700258d-01,&
       -8.0901700258d-01, -3.0901700258d-01, 5.0000000000d-01,&
       -3.0901700258d-01, -5.0000000000d-01, 8.0901700258d-01,&
       3.0901700258d-01, -5.0000000000d-01, 8.0901700258d-01,&
       -1.0000000000d+00, 0.0000000000d+00, 0.0000000000d+00,&
       -8.0901700258d-01, 3.0901700258d-01, -5.0000000000d-01,&
       -8.0901700258d-01, -3.0901700258d-01, -5.0000000000d-01&
       /),(/3,42/))
    nfsph(2) = 80
    fsph(1:3,1:80,2) = reshape((/&
       1, 13, 14,&
       13, 15, 14,&
       13, 2, 15,&
       14, 15, 5,&
       1, 14, 16,&
       14, 17, 16,&
       14, 5, 17,&
       16, 17, 10,&
       10, 17, 18,&
       17, 19, 18,&
       17, 5, 19,&
       18, 19, 6,&
       5, 20, 19,&
       20, 21, 19,&
       20, 9, 21,&
       19, 21, 6,&
       5, 15, 20,&
       15, 22, 20,&
       15, 2, 22,&
       20, 22, 9,&
       9, 22, 23,&
       22, 24, 23,&
       22, 2, 24,&
       23, 24, 11,&
       9, 23, 25,&
       23, 26, 25,&
       23, 11, 26,&
       25, 26, 4,&
       6, 21, 27,&
       21, 25, 27,&
       21, 9, 25,&
       27, 25, 4,&
       6, 27, 28,&
       27, 29, 28,&
       27, 4, 29,&
       28, 29, 3,&
       3, 29, 30,&
       29, 31, 30,&
       29, 4, 31,&
       30, 31, 8,&
       8, 31, 32,&
       31, 26, 32,&
       31, 4, 26,&
       32, 26, 11,&
       8, 32, 33,&
       32, 34, 33,&
       32, 11, 34,&
       33, 34, 7,&
       8, 33, 35,&
       33, 36, 35,&
       33, 7, 36,&
       35, 36, 12,&
       12, 36, 37,&
       36, 38, 37,&
       36, 7, 38,&
       37, 38, 1,&
       1, 38, 13,&
       38, 39, 13,&
       38, 7, 39,&
       13, 39, 2,&
       7, 34, 39,&
       34, 24, 39,&
       34, 11, 24,&
       39, 24, 2,&
       10, 40, 16,&
       40, 37, 16,&
       40, 12, 37,&
       16, 37, 1,&
       10, 41, 40,&
       41, 42, 40,&
       41, 3, 42,&
       40, 42, 12,&
       10, 18, 41,&
       18, 28, 41,&
       18, 6, 28,&
       41, 28, 3,&
       8, 35, 30,&
       35, 42, 30,&
       35, 12, 42,&
       30, 42, 3&
       /),(/3,80/))

    ! lvl 3 icosphere
    nvsph(3) = 162
    vsph(1:3,1:162,3) = reshape((/&
       -5.2573114634d-01, 0.0000000000d+00, 8.5065084696d-01,&
       5.2573114634d-01, 0.0000000000d+00, 8.5065084696d-01,&
       -5.2573114634d-01, 0.0000000000d+00, -8.5065084696d-01,&
       5.2573114634d-01, 0.0000000000d+00, -8.5065084696d-01,&
       0.0000000000d+00, 8.5065084696d-01, 5.2573114634d-01,&
       0.0000000000d+00, 8.5065084696d-01, -5.2573114634d-01,&
       0.0000000000d+00, -8.5065084696d-01, 5.2573114634d-01,&
       0.0000000000d+00, -8.5065084696d-01, -5.2573114634d-01,&
       8.5065084696d-01, 5.2573114634d-01, 0.0000000000d+00,&
       -8.5065084696d-01, 5.2573114634d-01, 0.0000000000d+00,&
       8.5065084696d-01, -5.2573114634d-01, 0.0000000000d+00,&
       -8.5065084696d-01, -5.2573114634d-01, 0.0000000000d+00,&
       0.0000000000d+00, 0.0000000000d+00, 1.0000000000d+00,&
       -3.0901700258d-01, 5.0000000000d-01, 8.0901700258d-01,&
       3.0901700258d-01, 5.0000000000d-01, 8.0901700258d-01,&
       -8.0901700258d-01, 3.0901700258d-01, 5.0000000000d-01,&
       -5.0000000000d-01, 8.0901700258d-01, 3.0901700258d-01,&
       -5.0000000000d-01, 8.0901700258d-01, -3.0901700258d-01,&
       0.0000000000d+00, 1.0000000000d+00, 0.0000000000d+00,&
       5.0000000000d-01, 8.0901700258d-01, 3.0901700258d-01,&
       5.0000000000d-01, 8.0901700258d-01, -3.0901700258d-01,&
       8.0901700258d-01, 3.0901700258d-01, 5.0000000000d-01,&
       1.0000000000d+00, 0.0000000000d+00, 0.0000000000d+00,&
       8.0901700258d-01, -3.0901700258d-01, 5.0000000000d-01,&
       8.0901700258d-01, 3.0901700258d-01, -5.0000000000d-01,&
       8.0901700258d-01, -3.0901700258d-01, -5.0000000000d-01,&
       3.0901700258d-01, 5.0000000000d-01, -8.0901700258d-01,&
       -3.0901700258d-01, 5.0000000000d-01, -8.0901700258d-01,&
       0.0000000000d+00, 0.0000000000d+00, -1.0000000000d+00,&
       -3.0901700258d-01, -5.0000000000d-01, -8.0901700258d-01,&
       3.0901700258d-01, -5.0000000000d-01, -8.0901700258d-01,&
       5.0000000000d-01, -8.0901700258d-01, -3.0901700258d-01,&
       0.0000000000d+00, -1.0000000000d+00, 0.0000000000d+00,&
       5.0000000000d-01, -8.0901700258d-01, 3.0901700258d-01,&
       -5.0000000000d-01, -8.0901700258d-01, -3.0901700258d-01,&
       -5.0000000000d-01, -8.0901700258d-01, 3.0901700258d-01,&
       -8.0901700258d-01, -3.0901700258d-01, 5.0000000000d-01,&
       -3.0901700258d-01, -5.0000000000d-01, 8.0901700258d-01,&
       3.0901700258d-01, -5.0000000000d-01, 8.0901700258d-01,&
       -1.0000000000d+00, 0.0000000000d+00, 0.0000000000d+00,&
       -8.0901700258d-01, 3.0901700258d-01, -5.0000000000d-01,&
       -8.0901700258d-01, -3.0901700258d-01, -5.0000000000d-01,&
       -2.7326655388d-01, 0.0000000000d+00, 9.6193832159d-01,&
       -4.3388858438d-01, 2.5989189744d-01, 8.6266845465d-01,&
       -1.6245986521d-01, 2.6286557317d-01, 9.5105654001d-01,&
       1.6245986521d-01, 2.6286557317d-01, 9.5105654001d-01,&
       0.0000000000d+00, 5.2573108673d-01, 8.5065078735d-01,&
       2.7326655388d-01, 0.0000000000d+00, 9.6193832159d-01,&
       4.3388858438d-01, 2.5989189744d-01, 8.6266845465d-01,&
       -1.6062203050d-01, 7.0204639435d-01, 6.9378048182d-01,&
       1.6062203050d-01, 7.0204639435d-01, 6.9378048182d-01,&
       -6.9378048182d-01, 1.6062203050d-01, 7.0204639435d-01,&
       -5.8778530359d-01, 4.2532542348d-01, 6.8819093704d-01,&
       -4.2532542348d-01, 6.8819093704d-01, 5.8778530359d-01,&
       -6.8819093704d-01, 5.8778530359d-01, 4.2532542348d-01,&
       -2.5989189744d-01, 8.6266845465d-01, 4.3388858438d-01,&
       -8.6266845465d-01, 4.3388858438d-01, 2.5989189744d-01,&
       -7.0204639435d-01, 6.9378048182d-01, 1.6062203050d-01,&
       -7.0204639435d-01, 6.9378048182d-01, -1.6062203050d-01,&
       -5.2573108673d-01, 8.5065078735d-01, 0.0000000000d+00,&
       -2.6286557317d-01, 9.5105654001d-01, 1.6245986521d-01,&
       -2.6286557317d-01, 9.5105654001d-01, -1.6245986521d-01,&
       0.0000000000d+00, 9.6193832159d-01, 2.7326655388d-01,&
       -2.5989189744d-01, 8.6266845465d-01, -4.3388858438d-01,&
       0.0000000000d+00, 9.6193832159d-01, -2.7326655388d-01,&
       2.5989189744d-01, 8.6266845465d-01, 4.3388858438d-01,&
       2.6286557317d-01, 9.5105654001d-01, 1.6245986521d-01,&
       5.2573108673d-01, 8.5065078735d-01, 0.0000000000d+00,&
       2.6286557317d-01, 9.5105654001d-01, -1.6245986521d-01,&
       7.0204639435d-01, 6.9378048182d-01, 1.6062203050d-01,&
       7.0204639435d-01, 6.9378048182d-01, -1.6062203050d-01,&
       2.5989189744d-01, 8.6266845465d-01, -4.3388858438d-01,&
       4.2532542348d-01, 6.8819093704d-01, 5.8778530359d-01,&
       5.8778530359d-01, 4.2532542348d-01, 6.8819093704d-01,&
       6.8819093704d-01, 5.8778530359d-01, 4.2532542348d-01,&
       6.9378048182d-01, 1.6062203050d-01, 7.0204639435d-01,&
       8.6266845465d-01, 4.3388858438d-01, 2.5989189744d-01,&
       9.6193832159d-01, 2.7326655388d-01, 0.0000000000d+00,&
       9.5105654001d-01, 1.6245986521d-01, 2.6286557317d-01,&
       8.5065078735d-01, 0.0000000000d+00, 5.2573108673d-01,&
       9.5105654001d-01, -1.6245986521d-01, 2.6286557317d-01,&
       6.9378048182d-01, -1.6062203050d-01, 7.0204639435d-01,&
       9.6193832159d-01, -2.7326655388d-01, 0.0000000000d+00,&
       8.6266845465d-01, -4.3388858438d-01, 2.5989189744d-01,&
       8.6266845465d-01, 4.3388858438d-01, -2.5989189744d-01,&
       9.5105654001d-01, 1.6245986521d-01, -2.6286557317d-01,&
       9.5105654001d-01, -1.6245986521d-01, -2.6286557317d-01,&
       8.5065078735d-01, 0.0000000000d+00, -5.2573108673d-01,&
       8.6266845465d-01, -4.3388858438d-01, -2.5989189744d-01,&
       6.9378048182d-01, 1.6062203050d-01, -7.0204639435d-01,&
       6.9378048182d-01, -1.6062203050d-01, -7.0204639435d-01,&
       1.6062203050d-01, 7.0204639435d-01, -6.9378048182d-01,&
       4.2532542348d-01, 6.8819093704d-01, -5.8778530359d-01,&
       6.8819093704d-01, 5.8778530359d-01, -4.2532542348d-01,&
       5.8778530359d-01, 4.2532542348d-01, -6.8819093704d-01,&
       4.3388858438d-01, 2.5989189744d-01, -8.6266845465d-01,&
       -1.6062203050d-01, 7.0204639435d-01, -6.9378048182d-01,&
       0.0000000000d+00, 5.2573108673d-01, -8.5065078735d-01,&
       1.6245986521d-01, 2.6286557317d-01, -9.5105654001d-01,&
       -1.6245986521d-01, 2.6286557317d-01, -9.5105654001d-01,&
       2.7326655388d-01, 0.0000000000d+00, -9.6193832159d-01,&
       -4.3388858438d-01, 2.5989189744d-01, -8.6266845465d-01,&
       -2.7326655388d-01, 0.0000000000d+00, -9.6193832159d-01,&
       -4.3388858438d-01, -2.5989189744d-01, -8.6266845465d-01,&
       -1.6245986521d-01, -2.6286557317d-01, -9.5105654001d-01,&
       1.6245986521d-01, -2.6286557317d-01, -9.5105654001d-01,&
       0.0000000000d+00, -5.2573108673d-01, -8.5065078735d-01,&
       4.3388858438d-01, -2.5989189744d-01, -8.6266845465d-01,&
       -1.6062203050d-01, -7.0204639435d-01, -6.9378048182d-01,&
       1.6062203050d-01, -7.0204639435d-01, -6.9378048182d-01,&
       2.5989189744d-01, -8.6266845465d-01, -4.3388858438d-01,&
       4.2532542348d-01, -6.8819093704d-01, -5.8778530359d-01,&
       5.8778530359d-01, -4.2532542348d-01, -6.8819093704d-01,&
       6.8819093704d-01, -5.8778530359d-01, -4.2532542348d-01,&
       7.0204639435d-01, -6.9378048182d-01, -1.6062203050d-01,&
       0.0000000000d+00, -9.6193832159d-01, -2.7326655388d-01,&
       2.6286557317d-01, -9.5105654001d-01, -1.6245986521d-01,&
       5.2573108673d-01, -8.5065078735d-01, 0.0000000000d+00,&
       2.6286557317d-01, -9.5105654001d-01, 1.6245986521d-01,&
       7.0204639435d-01, -6.9378048182d-01, 1.6062203050d-01,&
       0.0000000000d+00, -9.6193832159d-01, 2.7326655388d-01,&
       2.5989189744d-01, -8.6266845465d-01, 4.3388858438d-01,&
       -2.5989189744d-01, -8.6266845465d-01, -4.3388858438d-01,&
       -2.6286557317d-01, -9.5105654001d-01, -1.6245986521d-01,&
       -2.6286557317d-01, -9.5105654001d-01, 1.6245986521d-01,&
       -5.2573108673d-01, -8.5065078735d-01, 0.0000000000d+00,&
       -2.5989189744d-01, -8.6266845465d-01, 4.3388858438d-01,&
       -7.0204639435d-01, -6.9378048182d-01, -1.6062203050d-01,&
       -7.0204639435d-01, -6.9378048182d-01, 1.6062203050d-01,&
       -8.6266845465d-01, -4.3388858438d-01, 2.5989189744d-01,&
       -6.8819093704d-01, -5.8778530359d-01, 4.2532542348d-01,&
       -4.2532542348d-01, -6.8819093704d-01, 5.8778530359d-01,&
       -5.8778530359d-01, -4.2532542348d-01, 6.8819093704d-01,&
       -1.6062203050d-01, -7.0204639435d-01, 6.9378048182d-01,&
       -6.9378048182d-01, -1.6062203050d-01, 7.0204639435d-01,&
       -4.3388858438d-01, -2.5989189744d-01, 8.6266845465d-01,&
       -1.6245986521d-01, -2.6286557317d-01, 9.5105654001d-01,&
       0.0000000000d+00, -5.2573108673d-01, 8.5065078735d-01,&
       1.6245986521d-01, -2.6286557317d-01, 9.5105654001d-01,&
       1.6062203050d-01, -7.0204639435d-01, 6.9378048182d-01,&
       4.3388858438d-01, -2.5989189744d-01, 8.6266845465d-01,&
       4.2532542348d-01, -6.8819093704d-01, 5.8778530359d-01,&
       6.8819093704d-01, -5.8778530359d-01, 4.2532542348d-01,&
       5.8778530359d-01, -4.2532542348d-01, 6.8819093704d-01,&
       -9.6193832159d-01, 2.7326655388d-01, 0.0000000000d+00,&
       -9.5105654001d-01, 1.6245986521d-01, 2.6286557317d-01,&
       -9.5105654001d-01, -1.6245986521d-01, 2.6286557317d-01,&
       -8.5065078735d-01, 0.0000000000d+00, 5.2573108673d-01,&
       -9.6193832159d-01, -2.7326655388d-01, 0.0000000000d+00,&
       -8.6266845465d-01, 4.3388858438d-01, -2.5989189744d-01,&
       -9.5105654001d-01, 1.6245986521d-01, -2.6286557317d-01,&
       -8.5065078735d-01, 0.0000000000d+00, -5.2573108673d-01,&
       -9.5105654001d-01, -1.6245986521d-01, -2.6286557317d-01,&
       -6.9378048182d-01, 1.6062203050d-01, -7.0204639435d-01,&
       -6.9378048182d-01, -1.6062203050d-01, -7.0204639435d-01,&
       -8.6266845465d-01, -4.3388858438d-01, -2.5989189744d-01,&
       -6.8819093704d-01, 5.8778530359d-01, -4.2532542348d-01,&
       -4.2532542348d-01, 6.8819093704d-01, -5.8778530359d-01,&
       -5.8778530359d-01, 4.2532542348d-01, -6.8819093704d-01,&
       -4.2532542348d-01, -6.8819093704d-01, -5.8778530359d-01,&
       -6.8819093704d-01, -5.8778530359d-01, -4.2532542348d-01,&
       -5.8778530359d-01, -4.2532542348d-01, -6.8819093704d-01&
       /),(/3,162/))
    nfsph(3) = 320
    fsph(1:3,1:320,3) = reshape((/&
       1, 43, 44,&
       43, 45, 44,&
       43, 13, 45,&
       44, 45, 14,&
       13, 46, 45,&
       46, 47, 45,&
       46, 15, 47,&
       45, 47, 14,&
       13, 48, 46,&
       48, 49, 46,&
       48, 2, 49,&
       46, 49, 15,&
       14, 47, 50,&
       47, 51, 50,&
       47, 15, 51,&
       50, 51, 5,&
       1, 44, 52,&
       44, 53, 52,&
       44, 14, 53,&
       52, 53, 16,&
       14, 54, 53,&
       54, 55, 53,&
       54, 17, 55,&
       53, 55, 16,&
       14, 50, 54,&
       50, 56, 54,&
       50, 5, 56,&
       54, 56, 17,&
       16, 55, 57,&
       55, 58, 57,&
       55, 17, 58,&
       57, 58, 10,&
       10, 58, 59,&
       58, 60, 59,&
       58, 17, 60,&
       59, 60, 18,&
       17, 61, 60,&
       61, 62, 60,&
       61, 19, 62,&
       60, 62, 18,&
       17, 56, 61,&
       56, 63, 61,&
       56, 5, 63,&
       61, 63, 19,&
       18, 62, 64,&
       62, 65, 64,&
       62, 19, 65,&
       64, 65, 6,&
       5, 66, 63,&
       66, 67, 63,&
       66, 20, 67,&
       63, 67, 19,&
       20, 68, 67,&
       68, 69, 67,&
       68, 21, 69,&
       67, 69, 19,&
       20, 70, 68,&
       70, 71, 68,&
       70, 9, 71,&
       68, 71, 21,&
       19, 69, 65,&
       69, 72, 65,&
       69, 21, 72,&
       65, 72, 6,&
       5, 51, 66,&
       51, 73, 66,&
       51, 15, 73,&
       66, 73, 20,&
       15, 74, 73,&
       74, 75, 73,&
       74, 22, 75,&
       73, 75, 20,&
       15, 49, 74,&
       49, 76, 74,&
       49, 2, 76,&
       74, 76, 22,&
       20, 75, 70,&
       75, 77, 70,&
       75, 22, 77,&
       70, 77, 9,&
       9, 77, 78,&
       77, 79, 78,&
       77, 22, 79,&
       78, 79, 23,&
       22, 80, 79,&
       80, 81, 79,&
       80, 24, 81,&
       79, 81, 23,&
       22, 76, 80,&
       76, 82, 80,&
       76, 2, 82,&
       80, 82, 24,&
       23, 81, 83,&
       81, 84, 83,&
       81, 24, 84,&
       83, 84, 11,&
       9, 78, 85,&
       78, 86, 85,&
       78, 23, 86,&
       85, 86, 25,&
       23, 87, 86,&
       87, 88, 86,&
       87, 26, 88,&
       86, 88, 25,&
       23, 83, 87,&
       83, 89, 87,&
       83, 11, 89,&
       87, 89, 26,&
       25, 88, 90,&
       88, 91, 90,&
       88, 26, 91,&
       90, 91, 4,&
       6, 72, 92,&
       72, 93, 92,&
       72, 21, 93,&
       92, 93, 27,&
       21, 94, 93,&
       94, 95, 93,&
       94, 25, 95,&
       93, 95, 27,&
       21, 71, 94,&
       71, 85, 94,&
       71, 9, 85,&
       94, 85, 25,&
       27, 95, 96,&
       95, 90, 96,&
       95, 25, 90,&
       96, 90, 4,&
       6, 92, 97,&
       92, 98, 97,&
       92, 27, 98,&
       97, 98, 28,&
       27, 99, 98,&
       99, 100, 98,&
       99, 29, 100,&
       98, 100, 28,&
       27, 96, 99,&
       96, 101, 99,&
       96, 4, 101,&
       99, 101, 29,&
       28, 100, 102,&
       100, 103, 102,&
       100, 29, 103,&
       102, 103, 3,&
       3, 103, 104,&
       103, 105, 104,&
       103, 29, 105,&
       104, 105, 30,&
       29, 106, 105,&
       106, 107, 105,&
       106, 31, 107,&
       105, 107, 30,&
       29, 101, 106,&
       101, 108, 106,&
       101, 4, 108,&
       106, 108, 31,&
       30, 107, 109,&
       107, 110, 109,&
       107, 31, 110,&
       109, 110, 8,&
       8, 110, 111,&
       110, 112, 111,&
       110, 31, 112,&
       111, 112, 32,&
       31, 113, 112,&
       113, 114, 112,&
       113, 26, 114,&
       112, 114, 32,&
       31, 108, 113,&
       108, 91, 113,&
       108, 4, 91,&
       113, 91, 26,&
       32, 114, 115,&
       114, 89, 115,&
       114, 26, 89,&
       115, 89, 11,&
       8, 111, 116,&
       111, 117, 116,&
       111, 32, 117,&
       116, 117, 33,&
       32, 118, 117,&
       118, 119, 117,&
       118, 34, 119,&
       117, 119, 33,&
       32, 115, 118,&
       115, 120, 118,&
       115, 11, 120,&
       118, 120, 34,&
       33, 119, 121,&
       119, 122, 121,&
       119, 34, 122,&
       121, 122, 7,&
       8, 116, 123,&
       116, 124, 123,&
       116, 33, 124,&
       123, 124, 35,&
       33, 125, 124,&
       125, 126, 124,&
       125, 36, 126,&
       124, 126, 35,&
       33, 121, 125,&
       121, 127, 125,&
       121, 7, 127,&
       125, 127, 36,&
       35, 126, 128,&
       126, 129, 128,&
       126, 36, 129,&
       128, 129, 12,&
       12, 129, 130,&
       129, 131, 130,&
       129, 36, 131,&
       130, 131, 37,&
       36, 132, 131,&
       132, 133, 131,&
       132, 38, 133,&
       131, 133, 37,&
       36, 127, 132,&
       127, 134, 132,&
       127, 7, 134,&
       132, 134, 38,&
       37, 133, 135,&
       133, 136, 135,&
       133, 38, 136,&
       135, 136, 1,&
       1, 136, 43,&
       136, 137, 43,&
       136, 38, 137,&
       43, 137, 13,&
       38, 138, 137,&
       138, 139, 137,&
       138, 39, 139,&
       137, 139, 13,&
       38, 134, 138,&
       134, 140, 138,&
       134, 7, 140,&
       138, 140, 39,&
       13, 139, 48,&
       139, 141, 48,&
       139, 39, 141,&
       48, 141, 2,&
       7, 122, 140,&
       122, 142, 140,&
       122, 34, 142,&
       140, 142, 39,&
       34, 143, 142,&
       143, 144, 142,&
       143, 24, 144,&
       142, 144, 39,&
       34, 120, 143,&
       120, 84, 143,&
       120, 11, 84,&
       143, 84, 24,&
       39, 144, 141,&
       144, 82, 141,&
       144, 24, 82,&
       141, 82, 2,&
       10, 145, 57,&
       145, 146, 57,&
       145, 40, 146,&
       57, 146, 16,&
       40, 147, 146,&
       147, 148, 146,&
       147, 37, 148,&
       146, 148, 16,&
       40, 149, 147,&
       149, 130, 147,&
       149, 12, 130,&
       147, 130, 37,&
       16, 148, 52,&
       148, 135, 52,&
       148, 37, 135,&
       52, 135, 1,&
       10, 150, 145,&
       150, 151, 145,&
       150, 41, 151,&
       145, 151, 40,&
       41, 152, 151,&
       152, 153, 151,&
       152, 42, 153,&
       151, 153, 40,&
       41, 154, 152,&
       154, 155, 152,&
       154, 3, 155,&
       152, 155, 42,&
       40, 153, 149,&
       153, 156, 149,&
       153, 42, 156,&
       149, 156, 12,&
       10, 59, 150,&
       59, 157, 150,&
       59, 18, 157,&
       150, 157, 41,&
       18, 158, 157,&
       158, 159, 157,&
       158, 28, 159,&
       157, 159, 41,&
       18, 64, 158,&
       64, 97, 158,&
       64, 6, 97,&
       158, 97, 28,&
       41, 159, 154,&
       159, 102, 154,&
       159, 28, 102,&
       154, 102, 3,&
       8, 123, 109,&
       123, 160, 109,&
       123, 35, 160,&
       109, 160, 30,&
       35, 161, 160,&
       161, 162, 160,&
       161, 42, 162,&
       160, 162, 30,&
       35, 128, 161,&
       128, 156, 161,&
       128, 12, 156,&
       161, 156, 42,&
       30, 162, 104,&
       162, 155, 104,&
       162, 42, 155,&
       104, 155, 3&
       /),(/3,320/))

    ! lvl 4 icosphere
    nvsph(4) = 642
    vsph(1:3,1:642,4) = reshape((/&
       -5.2573114634d-01, 0.0000000000d+00, 8.5065084696d-01,&
       5.2573114634d-01, 0.0000000000d+00, 8.5065084696d-01,&
       -5.2573114634d-01, 0.0000000000d+00, -8.5065084696d-01,&
       5.2573114634d-01, 0.0000000000d+00, -8.5065084696d-01,&
       0.0000000000d+00, 8.5065084696d-01, 5.2573114634d-01,&
       0.0000000000d+00, 8.5065084696d-01, -5.2573114634d-01,&
       0.0000000000d+00, -8.5065084696d-01, 5.2573114634d-01,&
       0.0000000000d+00, -8.5065084696d-01, -5.2573114634d-01,&
       8.5065084696d-01, 5.2573114634d-01, 0.0000000000d+00,&
       -8.5065084696d-01, 5.2573114634d-01, 0.0000000000d+00,&
       8.5065084696d-01, -5.2573114634d-01, 0.0000000000d+00,&
       -8.5065084696d-01, -5.2573114634d-01, 0.0000000000d+00,&
       0.0000000000d+00, 0.0000000000d+00, 1.0000000000d+00,&
       -3.0901700258d-01, 5.0000000000d-01, 8.0901700258d-01,&
       3.0901700258d-01, 5.0000000000d-01, 8.0901700258d-01,&
       -8.0901700258d-01, 3.0901700258d-01, 5.0000000000d-01,&
       -5.0000000000d-01, 8.0901700258d-01, 3.0901700258d-01,&
       -5.0000000000d-01, 8.0901700258d-01, -3.0901700258d-01,&
       0.0000000000d+00, 1.0000000000d+00, 0.0000000000d+00,&
       5.0000000000d-01, 8.0901700258d-01, 3.0901700258d-01,&
       5.0000000000d-01, 8.0901700258d-01, -3.0901700258d-01,&
       8.0901700258d-01, 3.0901700258d-01, 5.0000000000d-01,&
       1.0000000000d+00, 0.0000000000d+00, 0.0000000000d+00,&
       8.0901700258d-01, -3.0901700258d-01, 5.0000000000d-01,&
       8.0901700258d-01, 3.0901700258d-01, -5.0000000000d-01,&
       8.0901700258d-01, -3.0901700258d-01, -5.0000000000d-01,&
       3.0901700258d-01, 5.0000000000d-01, -8.0901700258d-01,&
       -3.0901700258d-01, 5.0000000000d-01, -8.0901700258d-01,&
       0.0000000000d+00, 0.0000000000d+00, -1.0000000000d+00,&
       -3.0901700258d-01, -5.0000000000d-01, -8.0901700258d-01,&
       3.0901700258d-01, -5.0000000000d-01, -8.0901700258d-01,&
       5.0000000000d-01, -8.0901700258d-01, -3.0901700258d-01,&
       0.0000000000d+00, -1.0000000000d+00, 0.0000000000d+00,&
       5.0000000000d-01, -8.0901700258d-01, 3.0901700258d-01,&
       -5.0000000000d-01, -8.0901700258d-01, -3.0901700258d-01,&
       -5.0000000000d-01, -8.0901700258d-01, 3.0901700258d-01,&
       -8.0901700258d-01, -3.0901700258d-01, 5.0000000000d-01,&
       -3.0901700258d-01, -5.0000000000d-01, 8.0901700258d-01,&
       3.0901700258d-01, -5.0000000000d-01, 8.0901700258d-01,&
       -1.0000000000d+00, 0.0000000000d+00, 0.0000000000d+00,&
       -8.0901700258d-01, 3.0901700258d-01, -5.0000000000d-01,&
       -8.0901700258d-01, -3.0901700258d-01, -5.0000000000d-01,&
       -2.7326655388d-01, 0.0000000000d+00, 9.6193832159d-01,&
       -4.3388858438d-01, 2.5989189744d-01, 8.6266845465d-01,&
       -1.6245986521d-01, 2.6286557317d-01, 9.5105654001d-01,&
       1.6245986521d-01, 2.6286557317d-01, 9.5105654001d-01,&
       0.0000000000d+00, 5.2573108673d-01, 8.5065078735d-01,&
       2.7326655388d-01, 0.0000000000d+00, 9.6193832159d-01,&
       4.3388858438d-01, 2.5989189744d-01, 8.6266845465d-01,&
       -1.6062203050d-01, 7.0204639435d-01, 6.9378048182d-01,&
       1.6062203050d-01, 7.0204639435d-01, 6.9378048182d-01,&
       -6.9378048182d-01, 1.6062203050d-01, 7.0204639435d-01,&
       -5.8778530359d-01, 4.2532542348d-01, 6.8819093704d-01,&
       -4.2532542348d-01, 6.8819093704d-01, 5.8778530359d-01,&
       -6.8819093704d-01, 5.8778530359d-01, 4.2532542348d-01,&
       -2.5989189744d-01, 8.6266845465d-01, 4.3388858438d-01,&
       -8.6266845465d-01, 4.3388858438d-01, 2.5989189744d-01,&
       -7.0204639435d-01, 6.9378048182d-01, 1.6062203050d-01,&
       -7.0204639435d-01, 6.9378048182d-01, -1.6062203050d-01,&
       -5.2573108673d-01, 8.5065078735d-01, 0.0000000000d+00,&
       -2.6286557317d-01, 9.5105654001d-01, 1.6245986521d-01,&
       -2.6286557317d-01, 9.5105654001d-01, -1.6245986521d-01,&
       0.0000000000d+00, 9.6193832159d-01, 2.7326655388d-01,&
       -2.5989189744d-01, 8.6266845465d-01, -4.3388858438d-01,&
       0.0000000000d+00, 9.6193832159d-01, -2.7326655388d-01,&
       2.5989189744d-01, 8.6266845465d-01, 4.3388858438d-01,&
       2.6286557317d-01, 9.5105654001d-01, 1.6245986521d-01,&
       5.2573108673d-01, 8.5065078735d-01, 0.0000000000d+00,&
       2.6286557317d-01, 9.5105654001d-01, -1.6245986521d-01,&
       7.0204639435d-01, 6.9378048182d-01, 1.6062203050d-01,&
       7.0204639435d-01, 6.9378048182d-01, -1.6062203050d-01,&
       2.5989189744d-01, 8.6266845465d-01, -4.3388858438d-01,&
       4.2532542348d-01, 6.8819093704d-01, 5.8778530359d-01,&
       5.8778530359d-01, 4.2532542348d-01, 6.8819093704d-01,&
       6.8819093704d-01, 5.8778530359d-01, 4.2532542348d-01,&
       6.9378048182d-01, 1.6062203050d-01, 7.0204639435d-01,&
       8.6266845465d-01, 4.3388858438d-01, 2.5989189744d-01,&
       9.6193832159d-01, 2.7326655388d-01, 0.0000000000d+00,&
       9.5105654001d-01, 1.6245986521d-01, 2.6286557317d-01,&
       8.5065078735d-01, 0.0000000000d+00, 5.2573108673d-01,&
       9.5105654001d-01, -1.6245986521d-01, 2.6286557317d-01,&
       6.9378048182d-01, -1.6062203050d-01, 7.0204639435d-01,&
       9.6193832159d-01, -2.7326655388d-01, 0.0000000000d+00,&
       8.6266845465d-01, -4.3388858438d-01, 2.5989189744d-01,&
       8.6266845465d-01, 4.3388858438d-01, -2.5989189744d-01,&
       9.5105654001d-01, 1.6245986521d-01, -2.6286557317d-01,&
       9.5105654001d-01, -1.6245986521d-01, -2.6286557317d-01,&
       8.5065078735d-01, 0.0000000000d+00, -5.2573108673d-01,&
       8.6266845465d-01, -4.3388858438d-01, -2.5989189744d-01,&
       6.9378048182d-01, 1.6062203050d-01, -7.0204639435d-01,&
       6.9378048182d-01, -1.6062203050d-01, -7.0204639435d-01,&
       1.6062203050d-01, 7.0204639435d-01, -6.9378048182d-01,&
       4.2532542348d-01, 6.8819093704d-01, -5.8778530359d-01,&
       6.8819093704d-01, 5.8778530359d-01, -4.2532542348d-01,&
       5.8778530359d-01, 4.2532542348d-01, -6.8819093704d-01,&
       4.3388858438d-01, 2.5989189744d-01, -8.6266845465d-01,&
       -1.6062203050d-01, 7.0204639435d-01, -6.9378048182d-01,&
       0.0000000000d+00, 5.2573108673d-01, -8.5065078735d-01,&
       1.6245986521d-01, 2.6286557317d-01, -9.5105654001d-01,&
       -1.6245986521d-01, 2.6286557317d-01, -9.5105654001d-01,&
       2.7326655388d-01, 0.0000000000d+00, -9.6193832159d-01,&
       -4.3388858438d-01, 2.5989189744d-01, -8.6266845465d-01,&
       -2.7326655388d-01, 0.0000000000d+00, -9.6193832159d-01,&
       -4.3388858438d-01, -2.5989189744d-01, -8.6266845465d-01,&
       -1.6245986521d-01, -2.6286557317d-01, -9.5105654001d-01,&
       1.6245986521d-01, -2.6286557317d-01, -9.5105654001d-01,&
       0.0000000000d+00, -5.2573108673d-01, -8.5065078735d-01,&
       4.3388858438d-01, -2.5989189744d-01, -8.6266845465d-01,&
       -1.6062203050d-01, -7.0204639435d-01, -6.9378048182d-01,&
       1.6062203050d-01, -7.0204639435d-01, -6.9378048182d-01,&
       2.5989189744d-01, -8.6266845465d-01, -4.3388858438d-01,&
       4.2532542348d-01, -6.8819093704d-01, -5.8778530359d-01,&
       5.8778530359d-01, -4.2532542348d-01, -6.8819093704d-01,&
       6.8819093704d-01, -5.8778530359d-01, -4.2532542348d-01,&
       7.0204639435d-01, -6.9378048182d-01, -1.6062203050d-01,&
       0.0000000000d+00, -9.6193832159d-01, -2.7326655388d-01,&
       2.6286557317d-01, -9.5105654001d-01, -1.6245986521d-01,&
       5.2573108673d-01, -8.5065078735d-01, 0.0000000000d+00,&
       2.6286557317d-01, -9.5105654001d-01, 1.6245986521d-01,&
       7.0204639435d-01, -6.9378048182d-01, 1.6062203050d-01,&
       0.0000000000d+00, -9.6193832159d-01, 2.7326655388d-01,&
       2.5989189744d-01, -8.6266845465d-01, 4.3388858438d-01,&
       -2.5989189744d-01, -8.6266845465d-01, -4.3388858438d-01,&
       -2.6286557317d-01, -9.5105654001d-01, -1.6245986521d-01,&
       -2.6286557317d-01, -9.5105654001d-01, 1.6245986521d-01,&
       -5.2573108673d-01, -8.5065078735d-01, 0.0000000000d+00,&
       -2.5989189744d-01, -8.6266845465d-01, 4.3388858438d-01,&
       -7.0204639435d-01, -6.9378048182d-01, -1.6062203050d-01,&
       -7.0204639435d-01, -6.9378048182d-01, 1.6062203050d-01,&
       -8.6266845465d-01, -4.3388858438d-01, 2.5989189744d-01,&
       -6.8819093704d-01, -5.8778530359d-01, 4.2532542348d-01,&
       -4.2532542348d-01, -6.8819093704d-01, 5.8778530359d-01,&
       -5.8778530359d-01, -4.2532542348d-01, 6.8819093704d-01,&
       -1.6062203050d-01, -7.0204639435d-01, 6.9378048182d-01,&
       -6.9378048182d-01, -1.6062203050d-01, 7.0204639435d-01,&
       -4.3388858438d-01, -2.5989189744d-01, 8.6266845465d-01,&
       -1.6245986521d-01, -2.6286557317d-01, 9.5105654001d-01,&
       0.0000000000d+00, -5.2573108673d-01, 8.5065078735d-01,&
       1.6245986521d-01, -2.6286557317d-01, 9.5105654001d-01,&
       1.6062203050d-01, -7.0204639435d-01, 6.9378048182d-01,&
       4.3388858438d-01, -2.5989189744d-01, 8.6266845465d-01,&
       4.2532542348d-01, -6.8819093704d-01, 5.8778530359d-01,&
       6.8819093704d-01, -5.8778530359d-01, 4.2532542348d-01,&
       5.8778530359d-01, -4.2532542348d-01, 6.8819093704d-01,&
       -9.6193832159d-01, 2.7326655388d-01, 0.0000000000d+00,&
       -9.5105654001d-01, 1.6245986521d-01, 2.6286557317d-01,&
       -9.5105654001d-01, -1.6245986521d-01, 2.6286557317d-01,&
       -8.5065078735d-01, 0.0000000000d+00, 5.2573108673d-01,&
       -9.6193832159d-01, -2.7326655388d-01, 0.0000000000d+00,&
       -8.6266845465d-01, 4.3388858438d-01, -2.5989189744d-01,&
       -9.5105654001d-01, 1.6245986521d-01, -2.6286557317d-01,&
       -8.5065078735d-01, 0.0000000000d+00, -5.2573108673d-01,&
       -9.5105654001d-01, -1.6245986521d-01, -2.6286557317d-01,&
       -6.9378048182d-01, 1.6062203050d-01, -7.0204639435d-01,&
       -6.9378048182d-01, -1.6062203050d-01, -7.0204639435d-01,&
       -8.6266845465d-01, -4.3388858438d-01, -2.5989189744d-01,&
       -6.8819093704d-01, 5.8778530359d-01, -4.2532542348d-01,&
       -4.2532542348d-01, 6.8819093704d-01, -5.8778530359d-01,&
       -5.8778530359d-01, 4.2532542348d-01, -6.8819093704d-01,&
       -4.2532542348d-01, -6.8819093704d-01, -5.8778530359d-01,&
       -6.8819093704d-01, -5.8778530359d-01, -4.2532542348d-01,&
       -5.8778530359d-01, -4.2532542348d-01, -6.8819093704d-01,&
       -4.0335538983d-01, 0.0000000000d+00, 9.1504341364d-01,&
       -4.8444169760d-01, 1.3120037317d-01, 8.6492931843d-01,&
       -3.5822880268d-01, 1.3165536523d-01, 9.2430460453d-01,&
       -2.2011704743d-01, 1.3279248774d-01, 9.6639263630d-01,&
       -3.0125889182d-01, 2.6408272982d-01, 9.1624414921d-01,&
       -1.3795225322d-01, 0.0000000000d+00, 9.9043887854d-01,&
       -8.2242473960d-02, 1.3307112455d-01, 9.8768836260d-01,&
       -3.7503859401d-01, 3.8361370564d-01, 8.4391146898d-01,&
       -2.3867693543d-01, 3.8618737459d-01, 8.9100652933d-01,&
       8.2242473960d-02, 1.3307112455d-01, 9.8768836260d-01,&
       0.0000000000d+00, 2.6640471816d-01, 9.6386122704d-01,&
       8.2323588431d-02, 3.9960703254d-01, 9.1298246384d-01,&
       -8.2323588431d-02, 3.9960703254d-01, 9.1298246384d-01,&
       2.3867693543d-01, 3.8618737459d-01, 8.9100652933d-01,&
       1.5643447638d-01, 5.1925849915d-01, 8.4017789364d-01,&
       -1.5643447638d-01, 5.1925849915d-01, 8.4017789364d-01,&
       1.3795225322d-01, 0.0000000000d+00, 9.9043887854d-01,&
       2.2011704743d-01, 1.3279248774d-01, 9.6639263630d-01,&
       3.5822880268d-01, 1.3165536523d-01, 9.2430460453d-01,&
       3.0125889182d-01, 2.6408272982d-01, 9.1624414921d-01,&
       4.0335538983d-01, 0.0000000000d+00, 9.1504341364d-01,&
       4.8444169760d-01, 1.3120037317d-01, 8.6492931843d-01,&
       3.7503859401d-01, 3.8361370564d-01, 8.4391146898d-01,&
       -2.3708632588d-01, 6.0682511330d-01, 7.5865232944d-01,&
       -8.1141851842d-02, 6.2023955584d-01, 7.8020435572d-01,&
       8.1141851842d-02, 6.2023955584d-01, 7.8020435572d-01,&
       0.0000000000d+00, 7.1128171682d-01, 7.0290702581d-01,&
       2.3708632588d-01, 6.0682511330d-01, 7.5865232944d-01,&
       -8.1086292863d-02, 7.8384298086d-01, 6.1564207077d-01,&
       8.1086292863d-02, 7.8384298086d-01, 6.1564207077d-01,&
       -6.1564207077d-01, 8.1086292863d-02, 7.8384298086d-01,&
       -5.7125169039d-01, 2.1302284300d-01, 7.9264920950d-01,&
       -5.1612162590d-01, 3.4615299106d-01, 7.8345167637d-01,&
       -6.4741188288d-01, 2.9600459337d-01, 7.0230978727d-01,&
       -4.5399054885d-01, 4.6842986345d-01, 7.5793540478d-01,&
       -7.5865232944d-01, 2.3708632588d-01, 6.0682511330d-01,&
       -7.0710676908d-01, 3.7174805999d-01, 6.0150092840d-01,&
       -3.7174805999d-01, 6.0150092840d-01, 7.0710676908d-01,&
       -5.1337546110d-01, 5.6425416470d-01, 6.4657777548d-01,&
       -5.6425416470d-01, 6.4657777548d-01, 5.1337546110d-01,&
       -6.4657777548d-01, 5.1337546110d-01, 5.6425416470d-01,&
       -4.6842986345d-01, 7.5793540478d-01, 4.5399054885d-01,&
       -6.0150092840d-01, 7.0710676908d-01, 3.7174805999d-01,&
       -7.5793540478d-01, 4.5399054885d-01, 4.6842986345d-01,&
       -2.9600459337d-01, 7.0230978727d-01, 6.4741188288d-01,&
       -2.1302284300d-01, 7.9264920950d-01, 5.7125169039d-01,&
       -3.4615299106d-01, 7.8345167637d-01, 5.1612162590d-01,&
       -1.3120037317d-01, 8.6492931843d-01, 4.8444169760d-01,&
       -3.8361370564d-01, 8.4391146898d-01, 3.7503859401d-01,&
       -8.4391146898d-01, 3.7503859401d-01, 3.8361370564d-01,&
       -7.8345167637d-01, 5.1612162590d-01, 3.4615299106d-01,&
       -7.0230978727d-01, 6.4741188288d-01, 2.9600459337d-01,&
       -7.9264926910d-01, 5.7125169039d-01, 2.1302285790d-01,&
       -6.0682511330d-01, 7.5865232944d-01, 2.3708632588d-01,&
       -8.6492931843d-01, 4.8444169760d-01, 1.3120037317d-01,&
       -7.8384298086d-01, 6.1564207077d-01, 8.1086292863d-02,&
       -7.8384298086d-01, 6.1564207077d-01, -8.1086292863d-02,&
       -7.1128171682d-01, 7.0290702581d-01, 0.0000000000d+00,&
       -6.2023955584d-01, 7.8020435572d-01, 8.1141851842d-02,&
       -6.2023955584d-01, 7.8020435572d-01, -8.1141851842d-02,&
       -5.1925849915d-01, 8.4017789364d-01, 1.5643447638d-01,&
       -6.0682511330d-01, 7.5865232944d-01, -2.3708632588d-01,&
       -5.1925849915d-01, 8.4017789364d-01, -1.5643447638d-01,&
       -3.8618737459d-01, 8.9100652933d-01, 2.3867693543d-01,&
       -3.9960703254d-01, 9.1298246384d-01, 8.2323588431d-02,&
       -2.6640471816d-01, 9.6386122704d-01, 0.0000000000d+00,&
       -3.9960703254d-01, 9.1298246384d-01, -8.2323588431d-02,&
       -1.3307112455d-01, 9.8768836260d-01, 8.2242473960d-02,&
       -1.3307112455d-01, 9.8768836260d-01, -8.2242473960d-02,&
       -3.8618737459d-01, 8.9100652933d-01, -2.3867693543d-01,&
       -2.6408272982d-01, 9.1624414921d-01, 3.0125889182d-01,&
       -1.3165536523d-01, 9.2430460453d-01, 3.5822880268d-01,&
       -1.3279248774d-01, 9.6639263630d-01, 2.2011704743d-01,&
       0.0000000000d+00, 9.1504341364d-01, 4.0335538983d-01,&
       0.0000000000d+00, 9.9043887854d-01, 1.3795225322d-01,&
       -3.8361370564d-01, 8.4391146898d-01, -3.7503859401d-01,&
       -2.6408272982d-01, 9.1624414921d-01, -3.0125889182d-01,&
       -1.3279248774d-01, 9.6639263630d-01, -2.2011704743d-01,&
       -1.3165536523d-01, 9.2430460453d-01, -3.5822880268d-01,&
       0.0000000000d+00, 9.9043887854d-01, -1.3795225322d-01,&
       -1.3120037317d-01, 8.6492931843d-01, -4.8444169760d-01,&
       0.0000000000d+00, 9.1504341364d-01, -4.0335538983d-01,&
       1.3120037317d-01, 8.6492931843d-01, 4.8444169760d-01,&
       1.3165536523d-01, 9.2430460453d-01, 3.5822880268d-01,&
       2.6408272982d-01, 9.1624414921d-01, 3.0125889182d-01,&
       1.3279248774d-01, 9.6639263630d-01, 2.2011704743d-01,&
       3.8361370564d-01, 8.4391146898d-01, 3.7503859401d-01,&
       3.8618737459d-01, 8.9100652933d-01, 2.3867693543d-01,&
       1.3307112455d-01, 9.8768836260d-01, 8.2242473960d-02,&
       5.1925849915d-01, 8.4017789364d-01, 1.5643447638d-01,&
       3.9960703254d-01, 9.1298246384d-01, 8.2323588431d-02,&
       3.9960703254d-01, 9.1298246384d-01, -8.2323588431d-02,&
       2.6640471816d-01, 9.6386122704d-01, 0.0000000000d+00,&
       5.1925849915d-01, 8.4017789364d-01, -1.5643447638d-01,&
       3.8618737459d-01, 8.9100652933d-01, -2.3867693543d-01,&
       1.3307112455d-01, 9.8768836260d-01, -8.2242473960d-02,&
       6.0682511330d-01, 7.5865232944d-01, 2.3708632588d-01,&
       6.2023955584d-01, 7.8020435572d-01, 8.1141851842d-02,&
       7.1128171682d-01, 7.0290702581d-01, 0.0000000000d+00,&
       6.2023955584d-01, 7.8020435572d-01, -8.1141851842d-02,&
       7.8384298086d-01, 6.1564207077d-01, 8.1086292863d-02,&
       7.8384298086d-01, 6.1564207077d-01, -8.1086292863d-02,&
       6.0682511330d-01, 7.5865232944d-01, -2.3708632588d-01,&
       1.3279248774d-01, 9.6639263630d-01, -2.2011704743d-01,&
       2.6408272982d-01, 9.1624414921d-01, -3.0125889182d-01,&
       1.3165536523d-01, 9.2430460453d-01, -3.5822880268d-01,&
       3.8361370564d-01, 8.4391146898d-01, -3.7503859401d-01,&
       1.3120037317d-01, 8.6492931843d-01, -4.8444169760d-01,&
       2.1302284300d-01, 7.9264920950d-01, 5.7125169039d-01,&
       2.9600459337d-01, 7.0230978727d-01, 6.4741188288d-01,&
       3.4615299106d-01, 7.8345167637d-01, 5.1612162590d-01,&
       3.7174805999d-01, 6.0150092840d-01, 7.0710676908d-01,&
       4.6842986345d-01, 7.5793540478d-01, 4.5399054885d-01,&
       4.5399054885d-01, 4.6842986345d-01, 7.5793540478d-01,&
       5.1337546110d-01, 5.6425416470d-01, 6.4657777548d-01,&
       6.4657777548d-01, 5.1337546110d-01, 5.6425416470d-01,&
       5.6425416470d-01, 6.4657777548d-01, 5.1337546110d-01,&
       7.0710676908d-01, 3.7174805999d-01, 6.0150092840d-01,&
       7.5793540478d-01, 4.5399054885d-01, 4.6842986345d-01,&
       6.0150092840d-01, 7.0710676908d-01, 3.7174805999d-01,&
       5.1612162590d-01, 3.4615299106d-01, 7.8345167637d-01,&
       5.7125169039d-01, 2.1302284300d-01, 7.9264920950d-01,&
       6.4741188288d-01, 2.9600459337d-01, 7.0230978727d-01,&
       6.1564207077d-01, 8.1086292863d-02, 7.8384298086d-01,&
       7.5865232944d-01, 2.3708632588d-01, 6.0682511330d-01,&
       7.0230978727d-01, 6.4741188288d-01, 2.9600459337d-01,&
       7.8345167637d-01, 5.1612162590d-01, 3.4615299106d-01,&
       7.9264926910d-01, 5.7125169039d-01, 2.1302285790d-01,&
       8.4391146898d-01, 3.7503859401d-01, 3.8361370564d-01,&
       8.6492931843d-01, 4.8444169760d-01, 1.3120037317d-01,&
       9.1504341364d-01, 4.0335538983d-01, 0.0000000000d+00,&
       9.2430460453d-01, 3.5822880268d-01, 1.3165536523d-01,&
       9.1624414921d-01, 3.0125889182d-01, 2.6408272982d-01,&
       9.6639263630d-01, 2.2011704743d-01, 1.3279248774d-01,&
       8.9100652933d-01, 2.3867693543d-01, 3.8618737459d-01,&
       9.9043887854d-01, 1.3795225322d-01, 0.0000000000d+00,&
       9.8768836260d-01, 8.2242473960d-02, 1.3307112455d-01,&
       8.4017789364d-01, 1.5643447638d-01, 5.1925849915d-01,&
       9.1298246384d-01, 8.2323588431d-02, 3.9960703254d-01,&
       9.1298246384d-01, -8.2323588431d-02, 3.9960703254d-01,&
       9.6386122704d-01, 0.0000000000d+00, 2.6640471816d-01,&
       8.4017789364d-01, -1.5643447638d-01, 5.1925849915d-01,&
       8.9100652933d-01, -2.3867693543d-01, 3.8618737459d-01,&
       9.8768836260d-01, -8.2242473960d-02, 1.3307112455d-01,&
       7.8020435572d-01, 8.1141851842d-02, 6.2023955584d-01,&
       7.0290702581d-01, 0.0000000000d+00, 7.1128171682d-01,&
       7.8020435572d-01, -8.1141851842d-02, 6.2023955584d-01,&
       6.1564207077d-01, -8.1086292863d-02, 7.8384298086d-01,&
       7.5865232944d-01, -2.3708632588d-01, 6.0682511330d-01,&
       9.9043887854d-01, -1.3795225322d-01, 0.0000000000d+00,&
       9.6639263630d-01, -2.2011704743d-01, 1.3279248774d-01,&
       9.1624414921d-01, -3.0125889182d-01, 2.6408272982d-01,&
       9.2430460453d-01, -3.5822880268d-01, 1.3165536523d-01,&
       8.4391146898d-01, -3.7503859401d-01, 3.8361370564d-01,&
       9.1504341364d-01, -4.0335538983d-01, 0.0000000000d+00,&
       8.6492931843d-01, -4.8444169760d-01, 1.3120037317d-01,&
       8.6492931843d-01, 4.8444169760d-01, -1.3120037317d-01,&
       9.2430460453d-01, 3.5822880268d-01, -1.3165536523d-01,&
       9.6639263630d-01, 2.2011704743d-01, -1.3279248774d-01,&
       9.1624414921d-01, 3.0125889182d-01, -2.6408272982d-01,&
       9.8768836260d-01, 8.2242473960d-02, -1.3307112455d-01,&
       8.4391146898d-01, 3.7503859401d-01, -3.8361370564d-01,&
       8.9100652933d-01, 2.3867693543d-01, -3.8618737459d-01,&
       9.8768836260d-01, -8.2242473960d-02, -1.3307112455d-01,&
       9.6386122704d-01, 0.0000000000d+00, -2.6640471816d-01,&
       9.1298246384d-01, -8.2323588431d-02, -3.9960703254d-01,&
       9.1298246384d-01, 8.2323588431d-02, -3.9960703254d-01,&
       8.9100652933d-01, -2.3867693543d-01, -3.8618737459d-01,&
       8.4017789364d-01, -1.5643447638d-01, -5.1925849915d-01,&
       8.4017789364d-01, 1.5643447638d-01, -5.1925849915d-01,&
       9.6639263630d-01, -2.2011704743d-01, -1.3279248774d-01,&
       9.2430460453d-01, -3.5822880268d-01, -1.3165536523d-01,&
       9.1624414921d-01, -3.0125889182d-01, -2.6408272982d-01,&
       8.6492931843d-01, -4.8444169760d-01, -1.3120037317d-01,&
       8.4391146898d-01, -3.7503859401d-01, -3.8361370564d-01,&
       7.5865232944d-01, 2.3708632588d-01, -6.0682511330d-01,&
       7.8020435572d-01, 8.1141851842d-02, -6.2023955584d-01,&
       7.8020435572d-01, -8.1141851842d-02, -6.2023955584d-01,&
       7.0290702581d-01, 0.0000000000d+00, -7.1128171682d-01,&
       7.5865232944d-01, -2.3708632588d-01, -6.0682511330d-01,&
       6.1564207077d-01, 8.1086292863d-02, -7.8384298086d-01,&
       6.1564207077d-01, -8.1086292863d-02, -7.8384298086d-01,&
       8.1086292863d-02, 7.8384298086d-01, -6.1564207077d-01,&
       2.1302284300d-01, 7.9264920950d-01, -5.7125169039d-01,&
       3.4615299106d-01, 7.8345167637d-01, -5.1612162590d-01,&
       2.9600459337d-01, 7.0230978727d-01, -6.4741188288d-01,&
       4.6842986345d-01, 7.5793540478d-01, -4.5399054885d-01,&
       2.3708632588d-01, 6.0682511330d-01, -7.5865232944d-01,&
       3.7174805999d-01, 6.0150092840d-01, -7.0710676908d-01,&
       6.0150092840d-01, 7.0710676908d-01, -3.7174805999d-01,&
       5.6425416470d-01, 6.4657777548d-01, -5.1337546110d-01,&
       6.4657777548d-01, 5.1337546110d-01, -5.6425416470d-01,&
       5.1337546110d-01, 5.6425416470d-01, -6.4657777548d-01,&
       7.5793540478d-01, 4.5399054885d-01, -4.6842986345d-01,&
       7.0710676908d-01, 3.7174805999d-01, -6.0150092840d-01,&
       4.5399054885d-01, 4.6842986345d-01, -7.5793540478d-01,&
       7.0230978727d-01, 6.4741188288d-01, -2.9600459337d-01,&
       7.9264926910d-01, 5.7125169039d-01, -2.1302285790d-01,&
       7.8345167637d-01, 5.1612162590d-01, -3.4615299106d-01,&
       3.7503859401d-01, 3.8361370564d-01, -8.4391146898d-01,&
       5.1612162590d-01, 3.4615299106d-01, -7.8345167637d-01,&
       6.4741188288d-01, 2.9600459337d-01, -7.0230978727d-01,&
       5.7125169039d-01, 2.1302284300d-01, -7.9264920950d-01,&
       4.8444169760d-01, 1.3120037317d-01, -8.6492931843d-01,&
       -8.1086292863d-02, 7.8384298086d-01, -6.1564207077d-01,&
       0.0000000000d+00, 7.1128171682d-01, -7.0290702581d-01,&
       8.1141851842d-02, 6.2023955584d-01, -7.8020435572d-01,&
       -8.1141851842d-02, 6.2023955584d-01, -7.8020435572d-01,&
       1.5643447638d-01, 5.1925849915d-01, -8.4017789364d-01,&
       -2.3708632588d-01, 6.0682511330d-01, -7.5865232944d-01,&
       -1.5643447638d-01, 5.1925849915d-01, -8.4017789364d-01,&
       2.3867693543d-01, 3.8618737459d-01, -8.9100652933d-01,&
       8.2323588431d-02, 3.9960703254d-01, -9.1298246384d-01,&
       0.0000000000d+00, 2.6640471816d-01, -9.6386122704d-01,&
       -8.2323588431d-02, 3.9960703254d-01, -9.1298246384d-01,&
       8.2242473960d-02, 1.3307112455d-01, -9.8768836260d-01,&
       -8.2242473960d-02, 1.3307112455d-01, -9.8768836260d-01,&
       -2.3867693543d-01, 3.8618737459d-01, -8.9100652933d-01,&
       3.0125889182d-01, 2.6408272982d-01, -9.1624414921d-01,&
       3.5822880268d-01, 1.3165536523d-01, -9.2430460453d-01,&
       2.2011704743d-01, 1.3279248774d-01, -9.6639263630d-01,&
       4.0335538983d-01, 0.0000000000d+00, -9.1504341364d-01,&
       1.3795225322d-01, 0.0000000000d+00, -9.9043887854d-01,&
       -3.7503859401d-01, 3.8361370564d-01, -8.4391146898d-01,&
       -3.0125889182d-01, 2.6408272982d-01, -9.1624414921d-01,&
       -2.2011704743d-01, 1.3279248774d-01, -9.6639263630d-01,&
       -3.5822880268d-01, 1.3165536523d-01, -9.2430460453d-01,&
       -1.3795225322d-01, 0.0000000000d+00, -9.9043887854d-01,&
       -4.8444169760d-01, 1.3120037317d-01, -8.6492931843d-01,&
       -4.0335538983d-01, 0.0000000000d+00, -9.1504341364d-01,&
       -4.8444169760d-01, -1.3120037317d-01, -8.6492931843d-01,&
       -3.5822880268d-01, -1.3165536523d-01, -9.2430460453d-01,&
       -2.2011704743d-01, -1.3279248774d-01, -9.6639263630d-01,&
       -3.0125889182d-01, -2.6408272982d-01, -9.1624414921d-01,&
       -8.2242473960d-02, -1.3307112455d-01, -9.8768836260d-01,&
       -3.7503859401d-01, -3.8361370564d-01, -8.4391146898d-01,&
       -2.3867693543d-01, -3.8618737459d-01, -8.9100652933d-01,&
       8.2242473960d-02, -1.3307112455d-01, -9.8768836260d-01,&
       0.0000000000d+00, -2.6640471816d-01, -9.6386122704d-01,&
       8.2323588431d-02, -3.9960703254d-01, -9.1298246384d-01,&
       -8.2323588431d-02, -3.9960703254d-01, -9.1298246384d-01,&
       2.3867693543d-01, -3.8618737459d-01, -8.9100652933d-01,&
       1.5643447638d-01, -5.1925849915d-01, -8.4017789364d-01,&
       -1.5643447638d-01, -5.1925849915d-01, -8.4017789364d-01,&
       2.2011704743d-01, -1.3279248774d-01, -9.6639263630d-01,&
       3.5822880268d-01, -1.3165536523d-01, -9.2430460453d-01,&
       3.0125889182d-01, -2.6408272982d-01, -9.1624414921d-01,&
       4.8444169760d-01, -1.3120037317d-01, -8.6492931843d-01,&
       3.7503859401d-01, -3.8361370564d-01, -8.4391146898d-01,&
       -2.3708632588d-01, -6.0682511330d-01, -7.5865232944d-01,&
       -8.1141851842d-02, -6.2023955584d-01, -7.8020435572d-01,&
       8.1141851842d-02, -6.2023955584d-01, -7.8020435572d-01,&
       0.0000000000d+00, -7.1128171682d-01, -7.0290702581d-01,&
       2.3708632588d-01, -6.0682511330d-01, -7.5865232944d-01,&
       -8.1086292863d-02, -7.8384298086d-01, -6.1564207077d-01,&
       8.1086292863d-02, -7.8384298086d-01, -6.1564207077d-01,&
       1.3120037317d-01, -8.6492931843d-01, -4.8444169760d-01,&
       2.1302284300d-01, -7.9264920950d-01, -5.7125169039d-01,&
       2.9600459337d-01, -7.0230978727d-01, -6.4741188288d-01,&
       3.4615299106d-01, -7.8345167637d-01, -5.1612162590d-01,&
       3.7174805999d-01, -6.0150092840d-01, -7.0710676908d-01,&
       3.8361370564d-01, -8.4391146898d-01, -3.7503859401d-01,&
       4.6842986345d-01, -7.5793540478d-01, -4.5399054885d-01,&
       4.5399054885d-01, -4.6842986345d-01, -7.5793540478d-01,&
       5.1337546110d-01, -5.6425416470d-01, -6.4657777548d-01,&
       6.4657777548d-01, -5.1337546110d-01, -5.6425416470d-01,&
       5.6425416470d-01, -6.4657777548d-01, -5.1337546110d-01,&
       7.0710676908d-01, -3.7174805999d-01, -6.0150092840d-01,&
       7.5793540478d-01, -4.5399054885d-01, -4.6842986345d-01,&
       6.0150092840d-01, -7.0710676908d-01, -3.7174805999d-01,&
       5.1612162590d-01, -3.4615299106d-01, -7.8345167637d-01,&
       5.7125169039d-01, -2.1302284300d-01, -7.9264920950d-01,&
       6.4741188288d-01, -2.9600459337d-01, -7.0230978727d-01,&
       6.0682511330d-01, -7.5865232944d-01, -2.3708632588d-01,&
       7.0230978727d-01, -6.4741188288d-01, -2.9600459337d-01,&
       7.8345167637d-01, -5.1612162590d-01, -3.4615299106d-01,&
       7.9264926910d-01, -5.7125169039d-01, -2.1302285790d-01,&
       7.8384298086d-01, -6.1564207077d-01, -8.1086292863d-02,&
       0.0000000000d+00, -9.1504341364d-01, -4.0335538983d-01,&
       1.3165536523d-01, -9.2430460453d-01, -3.5822880268d-01,&
       2.6408272982d-01, -9.1624414921d-01, -3.0125889182d-01,&
       1.3279248774d-01, -9.6639263630d-01, -2.2011704743d-01,&
       3.8618737459d-01, -8.9100652933d-01, -2.3867693543d-01,&
       0.0000000000d+00, -9.9043887854d-01, -1.3795225322d-01,&
       1.3307112455d-01, -9.8768836260d-01, -8.2242473960d-02,&
       5.1925849915d-01, -8.4017789364d-01, -1.5643447638d-01,&
       3.9960703254d-01, -9.1298246384d-01, -8.2323588431d-02,&
       3.9960703254d-01, -9.1298246384d-01, 8.2323588431d-02,&
       2.6640471816d-01, -9.6386122704d-01, 0.0000000000d+00,&
       5.1925849915d-01, -8.4017789364d-01, 1.5643447638d-01,&
       3.8618737459d-01, -8.9100652933d-01, 2.3867693543d-01,&
       1.3307112455d-01, -9.8768836260d-01, 8.2242473960d-02,&
       6.2023955584d-01, -7.8020435572d-01, -8.1141851842d-02,&
       7.1128171682d-01, -7.0290702581d-01, 0.0000000000d+00,&
       6.2023955584d-01, -7.8020435572d-01, 8.1141851842d-02,&
       7.8384298086d-01, -6.1564207077d-01, 8.1086292863d-02,&
       6.0682511330d-01, -7.5865232944d-01, 2.3708632588d-01,&
       0.0000000000d+00, -9.9043887854d-01, 1.3795225322d-01,&
       1.3279248774d-01, -9.6639263630d-01, 2.2011704743d-01,&
       2.6408272982d-01, -9.1624414921d-01, 3.0125889182d-01,&
       1.3165536523d-01, -9.2430460453d-01, 3.5822880268d-01,&
       3.8361370564d-01, -8.4391146898d-01, 3.7503859401d-01,&
       0.0000000000d+00, -9.1504341364d-01, 4.0335538983d-01,&
       1.3120037317d-01, -8.6492931843d-01, 4.8444169760d-01,&
       -1.3120037317d-01, -8.6492931843d-01, -4.8444169760d-01,&
       -1.3165536523d-01, -9.2430460453d-01, -3.5822880268d-01,&
       -1.3279248774d-01, -9.6639263630d-01, -2.2011704743d-01,&
       -2.6408272982d-01, -9.1624414921d-01, -3.0125889182d-01,&
       -1.3307112455d-01, -9.8768836260d-01, -8.2242473960d-02,&
       -3.8361370564d-01, -8.4391146898d-01, -3.7503859401d-01,&
       -3.8618737459d-01, -8.9100652933d-01, -2.3867693543d-01,&
       -1.3307112455d-01, -9.8768836260d-01, 8.2242473960d-02,&
       -2.6640471816d-01, -9.6386122704d-01, 0.0000000000d+00,&
       -3.9960703254d-01, -9.1298246384d-01, 8.2323588431d-02,&
       -3.9960703254d-01, -9.1298246384d-01, -8.2323588431d-02,&
       -3.8618737459d-01, -8.9100652933d-01, 2.3867693543d-01,&
       -5.1925849915d-01, -8.4017789364d-01, 1.5643447638d-01,&
       -5.1925849915d-01, -8.4017789364d-01, -1.5643447638d-01,&
       -1.3279248774d-01, -9.6639263630d-01, 2.2011704743d-01,&
       -1.3165536523d-01, -9.2430460453d-01, 3.5822880268d-01,&
       -2.6408272982d-01, -9.1624414921d-01, 3.0125889182d-01,&
       -1.3120037317d-01, -8.6492931843d-01, 4.8444169760d-01,&
       -3.8361370564d-01, -8.4391146898d-01, 3.7503859401d-01,&
       -6.0682511330d-01, -7.5865232944d-01, -2.3708632588d-01,&
       -6.2023955584d-01, -7.8020435572d-01, -8.1141851842d-02,&
       -6.2023955584d-01, -7.8020435572d-01, 8.1141851842d-02,&
       -7.1128171682d-01, -7.0290702581d-01, 0.0000000000d+00,&
       -6.0682511330d-01, -7.5865232944d-01, 2.3708632588d-01,&
       -7.8384298086d-01, -6.1564207077d-01, -8.1086292863d-02,&
       -7.8384298086d-01, -6.1564207077d-01, 8.1086292863d-02,&
       -8.6492931843d-01, -4.8444169760d-01, 1.3120037317d-01,&
       -7.9264926910d-01, -5.7125169039d-01, 2.1302285790d-01,&
       -7.0230978727d-01, -6.4741188288d-01, 2.9600459337d-01,&
       -7.8345167637d-01, -5.1612162590d-01, 3.4615299106d-01,&
       -6.0150092840d-01, -7.0710676908d-01, 3.7174805999d-01,&
       -8.4391146898d-01, -3.7503859401d-01, 3.8361370564d-01,&
       -7.5793540478d-01, -4.5399054885d-01, 4.6842986345d-01,&
       -4.6842986345d-01, -7.5793540478d-01, 4.5399054885d-01,&
       -5.6425416470d-01, -6.4657777548d-01, 5.1337546110d-01,&
       -5.1337546110d-01, -5.6425416470d-01, 6.4657777548d-01,&
       -6.4657777548d-01, -5.1337546110d-01, 5.6425416470d-01,&
       -3.7174805999d-01, -6.0150092840d-01, 7.0710676908d-01,&
       -4.5399054885d-01, -4.6842986345d-01, 7.5793540478d-01,&
       -7.0710676908d-01, -3.7174805999d-01, 6.0150092840d-01,&
       -3.4615299106d-01, -7.8345167637d-01, 5.1612162590d-01,&
       -2.1302284300d-01, -7.9264920950d-01, 5.7125169039d-01,&
       -2.9600459337d-01, -7.0230978727d-01, 6.4741188288d-01,&
       -8.1086292863d-02, -7.8384298086d-01, 6.1564207077d-01,&
       -2.3708632588d-01, -6.0682511330d-01, 7.5865232944d-01,&
       -7.5865232944d-01, -2.3708632588d-01, 6.0682511330d-01,&
       -6.4741188288d-01, -2.9600459337d-01, 7.0230978727d-01,&
       -5.1612162590d-01, -3.4615299106d-01, 7.8345167637d-01,&
       -5.7125169039d-01, -2.1302284300d-01, 7.9264920950d-01,&
       -3.7503859401d-01, -3.8361370564d-01, 8.4391146898d-01,&
       -6.1564207077d-01, -8.1086292863d-02, 7.8384298086d-01,&
       -4.8444169760d-01, -1.3120037317d-01, 8.6492931843d-01,&
       -3.5822880268d-01, -1.3165536523d-01, 9.2430460453d-01,&
       -3.0125889182d-01, -2.6408272982d-01, 9.1624414921d-01,&
       -2.2011704743d-01, -1.3279248774d-01, 9.6639263630d-01,&
       -2.3867693543d-01, -3.8618737459d-01, 8.9100652933d-01,&
       -8.2242473960d-02, -1.3307112455d-01, 9.8768836260d-01,&
       -1.5643447638d-01, -5.1925849915d-01, 8.4017789364d-01,&
       -8.2323588431d-02, -3.9960703254d-01, 9.1298246384d-01,&
       8.2323588431d-02, -3.9960703254d-01, 9.1298246384d-01,&
       0.0000000000d+00, -2.6640471816d-01, 9.6386122704d-01,&
       1.5643447638d-01, -5.1925849915d-01, 8.4017789364d-01,&
       2.3867693543d-01, -3.8618737459d-01, 8.9100652933d-01,&
       8.2242473960d-02, -1.3307112455d-01, 9.8768836260d-01,&
       -8.1141851842d-02, -6.2023955584d-01, 7.8020435572d-01,&
       0.0000000000d+00, -7.1128171682d-01, 7.0290702581d-01,&
       8.1141851842d-02, -6.2023955584d-01, 7.8020435572d-01,&
       8.1086292863d-02, -7.8384298086d-01, 6.1564207077d-01,&
       2.3708632588d-01, -6.0682511330d-01, 7.5865232944d-01,&
       2.2011704743d-01, -1.3279248774d-01, 9.6639263630d-01,&
       3.0125889182d-01, -2.6408272982d-01, 9.1624414921d-01,&
       3.5822880268d-01, -1.3165536523d-01, 9.2430460453d-01,&
       3.7503859401d-01, -3.8361370564d-01, 8.4391146898d-01,&
       4.8444169760d-01, -1.3120037317d-01, 8.6492931843d-01,&
       2.1302284300d-01, -7.9264920950d-01, 5.7125169039d-01,&
       3.4615299106d-01, -7.8345167637d-01, 5.1612162590d-01,&
       2.9600459337d-01, -7.0230978727d-01, 6.4741188288d-01,&
       4.6842986345d-01, -7.5793540478d-01, 4.5399054885d-01,&
       3.7174805999d-01, -6.0150092840d-01, 7.0710676908d-01,&
       6.0150092840d-01, -7.0710676908d-01, 3.7174805999d-01,&
       5.6425416470d-01, -6.4657777548d-01, 5.1337546110d-01,&
       6.4657777548d-01, -5.1337546110d-01, 5.6425416470d-01,&
       5.1337546110d-01, -5.6425416470d-01, 6.4657777548d-01,&
       7.5793540478d-01, -4.5399054885d-01, 4.6842986345d-01,&
       7.0710676908d-01, -3.7174805999d-01, 6.0150092840d-01,&
       4.5399054885d-01, -4.6842986345d-01, 7.5793540478d-01,&
       7.0230978727d-01, -6.4741188288d-01, 2.9600459337d-01,&
       7.9264926910d-01, -5.7125169039d-01, 2.1302285790d-01,&
       7.8345167637d-01, -5.1612162590d-01, 3.4615299106d-01,&
       5.1612162590d-01, -3.4615299106d-01, 7.8345167637d-01,&
       6.4741188288d-01, -2.9600459337d-01, 7.0230978727d-01,&
       5.7125169039d-01, -2.1302284300d-01, 7.9264920950d-01,&
       -9.1504341364d-01, 4.0335538983d-01, 0.0000000000d+00,&
       -9.2430460453d-01, 3.5822880268d-01, 1.3165536523d-01,&
       -9.6639263630d-01, 2.2011704743d-01, 1.3279248774d-01,&
       -9.1624414921d-01, 3.0125889182d-01, 2.6408272982d-01,&
       -9.9043887854d-01, 1.3795225322d-01, 0.0000000000d+00,&
       -9.8768836260d-01, 8.2242473960d-02, 1.3307112455d-01,&
       -8.9100652933d-01, 2.3867693543d-01, 3.8618737459d-01,&
       -9.8768836260d-01, -8.2242473960d-02, 1.3307112455d-01,&
       -9.6386122704d-01, 0.0000000000d+00, 2.6640471816d-01,&
       -9.1298246384d-01, -8.2323588431d-02, 3.9960703254d-01,&
       -9.1298246384d-01, 8.2323588431d-02, 3.9960703254d-01,&
       -8.9100652933d-01, -2.3867693543d-01, 3.8618737459d-01,&
       -8.4017789364d-01, -1.5643447638d-01, 5.1925849915d-01,&
       -8.4017789364d-01, 1.5643447638d-01, 5.1925849915d-01,&
       -9.9043887854d-01, -1.3795225322d-01, 0.0000000000d+00,&
       -9.6639263630d-01, -2.2011704743d-01, 1.3279248774d-01,&
       -9.2430460453d-01, -3.5822880268d-01, 1.3165536523d-01,&
       -9.1624414921d-01, -3.0125889182d-01, 2.6408272982d-01,&
       -9.1504341364d-01, -4.0335538983d-01, 0.0000000000d+00,&
       -7.8020435572d-01, 8.1141851842d-02, 6.2023955584d-01,&
       -7.8020435572d-01, -8.1141851842d-02, 6.2023955584d-01,&
       -7.0290702581d-01, 0.0000000000d+00, 7.1128171682d-01,&
       -8.6492931843d-01, 4.8444169760d-01, -1.3120037317d-01,&
       -9.2430460453d-01, 3.5822880268d-01, -1.3165536523d-01,&
       -9.1624414921d-01, 3.0125889182d-01, -2.6408272982d-01,&
       -9.6639263630d-01, 2.2011704743d-01, -1.3279248774d-01,&
       -8.4391146898d-01, 3.7503859401d-01, -3.8361370564d-01,&
       -8.9100652933d-01, 2.3867693543d-01, -3.8618737459d-01,&
       -9.8768836260d-01, 8.2242473960d-02, -1.3307112455d-01,&
       -8.4017789364d-01, 1.5643447638d-01, -5.1925849915d-01,&
       -9.1298246384d-01, 8.2323588431d-02, -3.9960703254d-01,&
       -9.1298246384d-01, -8.2323588431d-02, -3.9960703254d-01,&
       -9.6386122704d-01, 0.0000000000d+00, -2.6640471816d-01,&
       -8.4017789364d-01, -1.5643447638d-01, -5.1925849915d-01,&
       -8.9100652933d-01, -2.3867693543d-01, -3.8618737459d-01,&
       -9.8768836260d-01, -8.2242473960d-02, -1.3307112455d-01,&
       -7.5865232944d-01, 2.3708632588d-01, -6.0682511330d-01,&
       -7.8020435572d-01, 8.1141851842d-02, -6.2023955584d-01,&
       -7.0290702581d-01, 0.0000000000d+00, -7.1128171682d-01,&
       -7.8020435572d-01, -8.1141851842d-02, -6.2023955584d-01,&
       -6.1564207077d-01, 8.1086292863d-02, -7.8384298086d-01,&
       -6.1564207077d-01, -8.1086292863d-02, -7.8384298086d-01,&
       -7.5865232944d-01, -2.3708632588d-01, -6.0682511330d-01,&
       -9.6639263630d-01, -2.2011704743d-01, -1.3279248774d-01,&
       -9.1624414921d-01, -3.0125889182d-01, -2.6408272982d-01,&
       -9.2430460453d-01, -3.5822880268d-01, -1.3165536523d-01,&
       -8.4391146898d-01, -3.7503859401d-01, -3.8361370564d-01,&
       -8.6492931843d-01, -4.8444169760d-01, -1.3120037317d-01,&
       -7.9264926910d-01, 5.7125169039d-01, -2.1302285790d-01,&
       -7.0230978727d-01, 6.4741188288d-01, -2.9600459337d-01,&
       -7.8345167637d-01, 5.1612162590d-01, -3.4615299106d-01,&
       -6.0150092840d-01, 7.0710676908d-01, -3.7174805999d-01,&
       -7.5793540478d-01, 4.5399054885d-01, -4.6842986345d-01,&
       -4.6842986345d-01, 7.5793540478d-01, -4.5399054885d-01,&
       -5.6425416470d-01, 6.4657777548d-01, -5.1337546110d-01,&
       -5.1337546110d-01, 5.6425416470d-01, -6.4657777548d-01,&
       -6.4657777548d-01, 5.1337546110d-01, -5.6425416470d-01,&
       -3.7174805999d-01, 6.0150092840d-01, -7.0710676908d-01,&
       -4.5399054885d-01, 4.6842986345d-01, -7.5793540478d-01,&
       -7.0710676908d-01, 3.7174805999d-01, -6.0150092840d-01,&
       -3.4615299106d-01, 7.8345167637d-01, -5.1612162590d-01,&
       -2.1302284300d-01, 7.9264920950d-01, -5.7125169039d-01,&
       -2.9600459337d-01, 7.0230978727d-01, -6.4741188288d-01,&
       -6.4741188288d-01, 2.9600459337d-01, -7.0230978727d-01,&
       -5.1612162590d-01, 3.4615299106d-01, -7.8345167637d-01,&
       -5.7125169039d-01, 2.1302284300d-01, -7.9264920950d-01,&
       -2.1302284300d-01, -7.9264920950d-01, -5.7125169039d-01,&
       -3.4615299106d-01, -7.8345167637d-01, -5.1612162590d-01,&
       -2.9600459337d-01, -7.0230978727d-01, -6.4741188288d-01,&
       -4.6842986345d-01, -7.5793540478d-01, -4.5399054885d-01,&
       -3.7174805999d-01, -6.0150092840d-01, -7.0710676908d-01,&
       -6.0150092840d-01, -7.0710676908d-01, -3.7174805999d-01,&
       -5.6425416470d-01, -6.4657777548d-01, -5.1337546110d-01,&
       -6.4657777548d-01, -5.1337546110d-01, -5.6425416470d-01,&
       -5.1337546110d-01, -5.6425416470d-01, -6.4657777548d-01,&
       -7.5793540478d-01, -4.5399054885d-01, -4.6842986345d-01,&
       -7.0710676908d-01, -3.7174805999d-01, -6.0150092840d-01,&
       -4.5399054885d-01, -4.6842986345d-01, -7.5793540478d-01,&
       -7.0230978727d-01, -6.4741188288d-01, -2.9600459337d-01,&
       -7.9264926910d-01, -5.7125169039d-01, -2.1302285790d-01,&
       -7.8345167637d-01, -5.1612162590d-01, -3.4615299106d-01,&
       -5.1612162590d-01, -3.4615299106d-01, -7.8345167637d-01,&
       -6.4741188288d-01, -2.9600459337d-01, -7.0230978727d-01,&
       -5.7125169039d-01, -2.1302284300d-01, -7.9264920950d-01&
       /),(/3,642/))
    nfsph(4) = 1280
    fsph(1:3,1:1280,4) = reshape((/&
       1, 163, 164,&
       163, 165, 164,&
       163, 43, 165,&
       164, 165, 44,&
       43, 166, 165,&
       166, 167, 165,&
       166, 45, 167,&
       165, 167, 44,&
       43, 168, 166,&
       168, 169, 166,&
       168, 13, 169,&
       166, 169, 45,&
       44, 167, 170,&
       167, 171, 170,&
       167, 45, 171,&
       170, 171, 14,&
       13, 172, 169,&
       172, 173, 169,&
       172, 46, 173,&
       169, 173, 45,&
       46, 174, 173,&
       174, 175, 173,&
       174, 47, 175,&
       173, 175, 45,&
       46, 176, 174,&
       176, 177, 174,&
       176, 15, 177,&
       174, 177, 47,&
       45, 175, 171,&
       175, 178, 171,&
       175, 47, 178,&
       171, 178, 14,&
       13, 179, 172,&
       179, 180, 172,&
       179, 48, 180,&
       172, 180, 46,&
       48, 181, 180,&
       181, 182, 180,&
       181, 49, 182,&
       180, 182, 46,&
       48, 183, 181,&
       183, 184, 181,&
       183, 2, 184,&
       181, 184, 49,&
       46, 182, 176,&
       182, 185, 176,&
       182, 49, 185,&
       176, 185, 15,&
       14, 178, 186,&
       178, 187, 186,&
       178, 47, 187,&
       186, 187, 50,&
       47, 188, 187,&
       188, 189, 187,&
       188, 51, 189,&
       187, 189, 50,&
       47, 177, 188,&
       177, 190, 188,&
       177, 15, 190,&
       188, 190, 51,&
       50, 189, 191,&
       189, 192, 191,&
       189, 51, 192,&
       191, 192, 5,&
       1, 164, 193,&
       164, 194, 193,&
       164, 44, 194,&
       193, 194, 52,&
       44, 195, 194,&
       195, 196, 194,&
       195, 53, 196,&
       194, 196, 52,&
       44, 170, 195,&
       170, 197, 195,&
       170, 14, 197,&
       195, 197, 53,&
       52, 196, 198,&
       196, 199, 198,&
       196, 53, 199,&
       198, 199, 16,&
       14, 200, 197,&
       200, 201, 197,&
       200, 54, 201,&
       197, 201, 53,&
       54, 202, 201,&
       202, 203, 201,&
       202, 55, 203,&
       201, 203, 53,&
       54, 204, 202,&
       204, 205, 202,&
       204, 17, 205,&
       202, 205, 55,&
       53, 203, 199,&
       203, 206, 199,&
       203, 55, 206,&
       199, 206, 16,&
       14, 186, 200,&
       186, 207, 200,&
       186, 50, 207,&
       200, 207, 54,&
       50, 208, 207,&
       208, 209, 207,&
       208, 56, 209,&
       207, 209, 54,&
       50, 191, 208,&
       191, 210, 208,&
       191, 5, 210,&
       208, 210, 56,&
       54, 209, 204,&
       209, 211, 204,&
       209, 56, 211,&
       204, 211, 17,&
       16, 206, 212,&
       206, 213, 212,&
       206, 55, 213,&
       212, 213, 57,&
       55, 214, 213,&
       214, 215, 213,&
       214, 58, 215,&
       213, 215, 57,&
       55, 205, 214,&
       205, 216, 214,&
       205, 17, 216,&
       214, 216, 58,&
       57, 215, 217,&
       215, 218, 217,&
       215, 58, 218,&
       217, 218, 10,&
       10, 218, 219,&
       218, 220, 219,&
       218, 58, 220,&
       219, 220, 59,&
       58, 221, 220,&
       221, 222, 220,&
       221, 60, 222,&
       220, 222, 59,&
       58, 216, 221,&
       216, 223, 221,&
       216, 17, 223,&
       221, 223, 60,&
       59, 222, 224,&
       222, 225, 224,&
       222, 60, 225,&
       224, 225, 18,&
       17, 226, 223,&
       226, 227, 223,&
       226, 61, 227,&
       223, 227, 60,&
       61, 228, 227,&
       228, 229, 227,&
       228, 62, 229,&
       227, 229, 60,&
       61, 230, 228,&
       230, 231, 228,&
       230, 19, 231,&
       228, 231, 62,&
       60, 229, 225,&
       229, 232, 225,&
       229, 62, 232,&
       225, 232, 18,&
       17, 211, 226,&
       211, 233, 226,&
       211, 56, 233,&
       226, 233, 61,&
       56, 234, 233,&
       234, 235, 233,&
       234, 63, 235,&
       233, 235, 61,&
       56, 210, 234,&
       210, 236, 234,&
       210, 5, 236,&
       234, 236, 63,&
       61, 235, 230,&
       235, 237, 230,&
       235, 63, 237,&
       230, 237, 19,&
       18, 232, 238,&
       232, 239, 238,&
       232, 62, 239,&
       238, 239, 64,&
       62, 240, 239,&
       240, 241, 239,&
       240, 65, 241,&
       239, 241, 64,&
       62, 231, 240,&
       231, 242, 240,&
       231, 19, 242,&
       240, 242, 65,&
       64, 241, 243,&
       241, 244, 243,&
       241, 65, 244,&
       243, 244, 6,&
       5, 245, 236,&
       245, 246, 236,&
       245, 66, 246,&
       236, 246, 63,&
       66, 247, 246,&
       247, 248, 246,&
       247, 67, 248,&
       246, 248, 63,&
       66, 249, 247,&
       249, 250, 247,&
       249, 20, 250,&
       247, 250, 67,&
       63, 248, 237,&
       248, 251, 237,&
       248, 67, 251,&
       237, 251, 19,&
       20, 252, 250,&
       252, 253, 250,&
       252, 68, 253,&
       250, 253, 67,&
       68, 254, 253,&
       254, 255, 253,&
       254, 69, 255,&
       253, 255, 67,&
       68, 256, 254,&
       256, 257, 254,&
       256, 21, 257,&
       254, 257, 69,&
       67, 255, 251,&
       255, 258, 251,&
       255, 69, 258,&
       251, 258, 19,&
       20, 259, 252,&
       259, 260, 252,&
       259, 70, 260,&
       252, 260, 68,&
       70, 261, 260,&
       261, 262, 260,&
       261, 71, 262,&
       260, 262, 68,&
       70, 263, 261,&
       263, 264, 261,&
       263, 9, 264,&
       261, 264, 71,&
       68, 262, 256,&
       262, 265, 256,&
       262, 71, 265,&
       256, 265, 21,&
       19, 258, 242,&
       258, 266, 242,&
       258, 69, 266,&
       242, 266, 65,&
       69, 267, 266,&
       267, 268, 266,&
       267, 72, 268,&
       266, 268, 65,&
       69, 257, 267,&
       257, 269, 267,&
       257, 21, 269,&
       267, 269, 72,&
       65, 268, 244,&
       268, 270, 244,&
       268, 72, 270,&
       244, 270, 6,&
       5, 192, 245,&
       192, 271, 245,&
       192, 51, 271,&
       245, 271, 66,&
       51, 272, 271,&
       272, 273, 271,&
       272, 73, 273,&
       271, 273, 66,&
       51, 190, 272,&
       190, 274, 272,&
       190, 15, 274,&
       272, 274, 73,&
       66, 273, 249,&
       273, 275, 249,&
       273, 73, 275,&
       249, 275, 20,&
       15, 276, 274,&
       276, 277, 274,&
       276, 74, 277,&
       274, 277, 73,&
       74, 278, 277,&
       278, 279, 277,&
       278, 75, 279,&
       277, 279, 73,&
       74, 280, 278,&
       280, 281, 278,&
       280, 22, 281,&
       278, 281, 75,&
       73, 279, 275,&
       279, 282, 275,&
       279, 75, 282,&
       275, 282, 20,&
       15, 185, 276,&
       185, 283, 276,&
       185, 49, 283,&
       276, 283, 74,&
       49, 284, 283,&
       284, 285, 283,&
       284, 76, 285,&
       283, 285, 74,&
       49, 184, 284,&
       184, 286, 284,&
       184, 2, 286,&
       284, 286, 76,&
       74, 285, 280,&
       285, 287, 280,&
       285, 76, 287,&
       280, 287, 22,&
       20, 282, 259,&
       282, 288, 259,&
       282, 75, 288,&
       259, 288, 70,&
       75, 289, 288,&
       289, 290, 288,&
       289, 77, 290,&
       288, 290, 70,&
       75, 281, 289,&
       281, 291, 289,&
       281, 22, 291,&
       289, 291, 77,&
       70, 290, 263,&
       290, 292, 263,&
       290, 77, 292,&
       263, 292, 9,&
       9, 292, 293,&
       292, 294, 293,&
       292, 77, 294,&
       293, 294, 78,&
       77, 295, 294,&
       295, 296, 294,&
       295, 79, 296,&
       294, 296, 78,&
       77, 291, 295,&
       291, 297, 295,&
       291, 22, 297,&
       295, 297, 79,&
       78, 296, 298,&
       296, 299, 298,&
       296, 79, 299,&
       298, 299, 23,&
       22, 300, 297,&
       300, 301, 297,&
       300, 80, 301,&
       297, 301, 79,&
       80, 302, 301,&
       302, 303, 301,&
       302, 81, 303,&
       301, 303, 79,&
       80, 304, 302,&
       304, 305, 302,&
       304, 24, 305,&
       302, 305, 81,&
       79, 303, 299,&
       303, 306, 299,&
       303, 81, 306,&
       299, 306, 23,&
       22, 287, 300,&
       287, 307, 300,&
       287, 76, 307,&
       300, 307, 80,&
       76, 308, 307,&
       308, 309, 307,&
       308, 82, 309,&
       307, 309, 80,&
       76, 286, 308,&
       286, 310, 308,&
       286, 2, 310,&
       308, 310, 82,&
       80, 309, 304,&
       309, 311, 304,&
       309, 82, 311,&
       304, 311, 24,&
       23, 306, 312,&
       306, 313, 312,&
       306, 81, 313,&
       312, 313, 83,&
       81, 314, 313,&
       314, 315, 313,&
       314, 84, 315,&
       313, 315, 83,&
       81, 305, 314,&
       305, 316, 314,&
       305, 24, 316,&
       314, 316, 84,&
       83, 315, 317,&
       315, 318, 317,&
       315, 84, 318,&
       317, 318, 11,&
       9, 293, 319,&
       293, 320, 319,&
       293, 78, 320,&
       319, 320, 85,&
       78, 321, 320,&
       321, 322, 320,&
       321, 86, 322,&
       320, 322, 85,&
       78, 298, 321,&
       298, 323, 321,&
       298, 23, 323,&
       321, 323, 86,&
       85, 322, 324,&
       322, 325, 324,&
       322, 86, 325,&
       324, 325, 25,&
       23, 326, 323,&
       326, 327, 323,&
       326, 87, 327,&
       323, 327, 86,&
       87, 328, 327,&
       328, 329, 327,&
       328, 88, 329,&
       327, 329, 86,&
       87, 330, 328,&
       330, 331, 328,&
       330, 26, 331,&
       328, 331, 88,&
       86, 329, 325,&
       329, 332, 325,&
       329, 88, 332,&
       325, 332, 25,&
       23, 312, 326,&
       312, 333, 326,&
       312, 83, 333,&
       326, 333, 87,&
       83, 334, 333,&
       334, 335, 333,&
       334, 89, 335,&
       333, 335, 87,&
       83, 317, 334,&
       317, 336, 334,&
       317, 11, 336,&
       334, 336, 89,&
       87, 335, 330,&
       335, 337, 330,&
       335, 89, 337,&
       330, 337, 26,&
       25, 332, 338,&
       332, 339, 338,&
       332, 88, 339,&
       338, 339, 90,&
       88, 340, 339,&
       340, 341, 339,&
       340, 91, 341,&
       339, 341, 90,&
       88, 331, 340,&
       331, 342, 340,&
       331, 26, 342,&
       340, 342, 91,&
       90, 341, 343,&
       341, 344, 343,&
       341, 91, 344,&
       343, 344, 4,&
       6, 270, 345,&
       270, 346, 345,&
       270, 72, 346,&
       345, 346, 92,&
       72, 347, 346,&
       347, 348, 346,&
       347, 93, 348,&
       346, 348, 92,&
       72, 269, 347,&
       269, 349, 347,&
       269, 21, 349,&
       347, 349, 93,&
       92, 348, 350,&
       348, 351, 350,&
       348, 93, 351,&
       350, 351, 27,&
       21, 352, 349,&
       352, 353, 349,&
       352, 94, 353,&
       349, 353, 93,&
       94, 354, 353,&
       354, 355, 353,&
       354, 95, 355,&
       353, 355, 93,&
       94, 356, 354,&
       356, 357, 354,&
       356, 25, 357,&
       354, 357, 95,&
       93, 355, 351,&
       355, 358, 351,&
       355, 95, 358,&
       351, 358, 27,&
       21, 265, 352,&
       265, 359, 352,&
       265, 71, 359,&
       352, 359, 94,&
       71, 360, 359,&
       360, 361, 359,&
       360, 85, 361,&
       359, 361, 94,&
       71, 264, 360,&
       264, 319, 360,&
       264, 9, 319,&
       360, 319, 85,&
       94, 361, 356,&
       361, 324, 356,&
       361, 85, 324,&
       356, 324, 25,&
       27, 358, 362,&
       358, 363, 362,&
       358, 95, 363,&
       362, 363, 96,&
       95, 364, 363,&
       364, 365, 363,&
       364, 90, 365,&
       363, 365, 96,&
       95, 357, 364,&
       357, 338, 364,&
       357, 25, 338,&
       364, 338, 90,&
       96, 365, 366,&
       365, 343, 366,&
       365, 90, 343,&
       366, 343, 4,&
       6, 345, 367,&
       345, 368, 367,&
       345, 92, 368,&
       367, 368, 97,&
       92, 369, 368,&
       369, 370, 368,&
       369, 98, 370,&
       368, 370, 97,&
       92, 350, 369,&
       350, 371, 369,&
       350, 27, 371,&
       369, 371, 98,&
       97, 370, 372,&
       370, 373, 372,&
       370, 98, 373,&
       372, 373, 28,&
       27, 374, 371,&
       374, 375, 371,&
       374, 99, 375,&
       371, 375, 98,&
       99, 376, 375,&
       376, 377, 375,&
       376, 100, 377,&
       375, 377, 98,&
       99, 378, 376,&
       378, 379, 376,&
       378, 29, 379,&
       376, 379, 100,&
       98, 377, 373,&
       377, 380, 373,&
       377, 100, 380,&
       373, 380, 28,&
       27, 362, 374,&
       362, 381, 374,&
       362, 96, 381,&
       374, 381, 99,&
       96, 382, 381,&
       382, 383, 381,&
       382, 101, 383,&
       381, 383, 99,&
       96, 366, 382,&
       366, 384, 382,&
       366, 4, 384,&
       382, 384, 101,&
       99, 383, 378,&
       383, 385, 378,&
       383, 101, 385,&
       378, 385, 29,&
       28, 380, 386,&
       380, 387, 386,&
       380, 100, 387,&
       386, 387, 102,&
       100, 388, 387,&
       388, 389, 387,&
       388, 103, 389,&
       387, 389, 102,&
       100, 379, 388,&
       379, 390, 388,&
       379, 29, 390,&
       388, 390, 103,&
       102, 389, 391,&
       389, 392, 391,&
       389, 103, 392,&
       391, 392, 3,&
       3, 392, 393,&
       392, 394, 393,&
       392, 103, 394,&
       393, 394, 104,&
       103, 395, 394,&
       395, 396, 394,&
       395, 105, 396,&
       394, 396, 104,&
       103, 390, 395,&
       390, 397, 395,&
       390, 29, 397,&
       395, 397, 105,&
       104, 396, 398,&
       396, 399, 398,&
       396, 105, 399,&
       398, 399, 30,&
       29, 400, 397,&
       400, 401, 397,&
       400, 106, 401,&
       397, 401, 105,&
       106, 402, 401,&
       402, 403, 401,&
       402, 107, 403,&
       401, 403, 105,&
       106, 404, 402,&
       404, 405, 402,&
       404, 31, 405,&
       402, 405, 107,&
       105, 403, 399,&
       403, 406, 399,&
       403, 107, 406,&
       399, 406, 30,&
       29, 385, 400,&
       385, 407, 400,&
       385, 101, 407,&
       400, 407, 106,&
       101, 408, 407,&
       408, 409, 407,&
       408, 108, 409,&
       407, 409, 106,&
       101, 384, 408,&
       384, 410, 408,&
       384, 4, 410,&
       408, 410, 108,&
       106, 409, 404,&
       409, 411, 404,&
       409, 108, 411,&
       404, 411, 31,&
       30, 406, 412,&
       406, 413, 412,&
       406, 107, 413,&
       412, 413, 109,&
       107, 414, 413,&
       414, 415, 413,&
       414, 110, 415,&
       413, 415, 109,&
       107, 405, 414,&
       405, 416, 414,&
       405, 31, 416,&
       414, 416, 110,&
       109, 415, 417,&
       415, 418, 417,&
       415, 110, 418,&
       417, 418, 8,&
       8, 418, 419,&
       418, 420, 419,&
       418, 110, 420,&
       419, 420, 111,&
       110, 421, 420,&
       421, 422, 420,&
       421, 112, 422,&
       420, 422, 111,&
       110, 416, 421,&
       416, 423, 421,&
       416, 31, 423,&
       421, 423, 112,&
       111, 422, 424,&
       422, 425, 424,&
       422, 112, 425,&
       424, 425, 32,&
       31, 426, 423,&
       426, 427, 423,&
       426, 113, 427,&
       423, 427, 112,&
       113, 428, 427,&
       428, 429, 427,&
       428, 114, 429,&
       427, 429, 112,&
       113, 430, 428,&
       430, 431, 428,&
       430, 26, 431,&
       428, 431, 114,&
       112, 429, 425,&
       429, 432, 425,&
       429, 114, 432,&
       425, 432, 32,&
       31, 411, 426,&
       411, 433, 426,&
       411, 108, 433,&
       426, 433, 113,&
       108, 434, 433,&
       434, 435, 433,&
       434, 91, 435,&
       433, 435, 113,&
       108, 410, 434,&
       410, 344, 434,&
       410, 4, 344,&
       434, 344, 91,&
       113, 435, 430,&
       435, 342, 430,&
       435, 91, 342,&
       430, 342, 26,&
       32, 432, 436,&
       432, 437, 436,&
       432, 114, 437,&
       436, 437, 115,&
       114, 438, 437,&
       438, 439, 437,&
       438, 89, 439,&
       437, 439, 115,&
       114, 431, 438,&
       431, 337, 438,&
       431, 26, 337,&
       438, 337, 89,&
       115, 439, 440,&
       439, 336, 440,&
       439, 89, 336,&
       440, 336, 11,&
       8, 419, 441,&
       419, 442, 441,&
       419, 111, 442,&
       441, 442, 116,&
       111, 443, 442,&
       443, 444, 442,&
       443, 117, 444,&
       442, 444, 116,&
       111, 424, 443,&
       424, 445, 443,&
       424, 32, 445,&
       443, 445, 117,&
       116, 444, 446,&
       444, 447, 446,&
       444, 117, 447,&
       446, 447, 33,&
       32, 448, 445,&
       448, 449, 445,&
       448, 118, 449,&
       445, 449, 117,&
       118, 450, 449,&
       450, 451, 449,&
       450, 119, 451,&
       449, 451, 117,&
       118, 452, 450,&
       452, 453, 450,&
       452, 34, 453,&
       450, 453, 119,&
       117, 451, 447,&
       451, 454, 447,&
       451, 119, 454,&
       447, 454, 33,&
       32, 436, 448,&
       436, 455, 448,&
       436, 115, 455,&
       448, 455, 118,&
       115, 456, 455,&
       456, 457, 455,&
       456, 120, 457,&
       455, 457, 118,&
       115, 440, 456,&
       440, 458, 456,&
       440, 11, 458,&
       456, 458, 120,&
       118, 457, 452,&
       457, 459, 452,&
       457, 120, 459,&
       452, 459, 34,&
       33, 454, 460,&
       454, 461, 460,&
       454, 119, 461,&
       460, 461, 121,&
       119, 462, 461,&
       462, 463, 461,&
       462, 122, 463,&
       461, 463, 121,&
       119, 453, 462,&
       453, 464, 462,&
       453, 34, 464,&
       462, 464, 122,&
       121, 463, 465,&
       463, 466, 465,&
       463, 122, 466,&
       465, 466, 7,&
       8, 441, 467,&
       441, 468, 467,&
       441, 116, 468,&
       467, 468, 123,&
       116, 469, 468,&
       469, 470, 468,&
       469, 124, 470,&
       468, 470, 123,&
       116, 446, 469,&
       446, 471, 469,&
       446, 33, 471,&
       469, 471, 124,&
       123, 470, 472,&
       470, 473, 472,&
       470, 124, 473,&
       472, 473, 35,&
       33, 474, 471,&
       474, 475, 471,&
       474, 125, 475,&
       471, 475, 124,&
       125, 476, 475,&
       476, 477, 475,&
       476, 126, 477,&
       475, 477, 124,&
       125, 478, 476,&
       478, 479, 476,&
       478, 36, 479,&
       476, 479, 126,&
       124, 477, 473,&
       477, 480, 473,&
       477, 126, 480,&
       473, 480, 35,&
       33, 460, 474,&
       460, 481, 474,&
       460, 121, 481,&
       474, 481, 125,&
       121, 482, 481,&
       482, 483, 481,&
       482, 127, 483,&
       481, 483, 125,&
       121, 465, 482,&
       465, 484, 482,&
       465, 7, 484,&
       482, 484, 127,&
       125, 483, 478,&
       483, 485, 478,&
       483, 127, 485,&
       478, 485, 36,&
       35, 480, 486,&
       480, 487, 486,&
       480, 126, 487,&
       486, 487, 128,&
       126, 488, 487,&
       488, 489, 487,&
       488, 129, 489,&
       487, 489, 128,&
       126, 479, 488,&
       479, 490, 488,&
       479, 36, 490,&
       488, 490, 129,&
       128, 489, 491,&
       489, 492, 491,&
       489, 129, 492,&
       491, 492, 12,&
       12, 492, 493,&
       492, 494, 493,&
       492, 129, 494,&
       493, 494, 130,&
       129, 495, 494,&
       495, 496, 494,&
       495, 131, 496,&
       494, 496, 130,&
       129, 490, 495,&
       490, 497, 495,&
       490, 36, 497,&
       495, 497, 131,&
       130, 496, 498,&
       496, 499, 498,&
       496, 131, 499,&
       498, 499, 37,&
       36, 500, 497,&
       500, 501, 497,&
       500, 132, 501,&
       497, 501, 131,&
       132, 502, 501,&
       502, 503, 501,&
       502, 133, 503,&
       501, 503, 131,&
       132, 504, 502,&
       504, 505, 502,&
       504, 38, 505,&
       502, 505, 133,&
       131, 503, 499,&
       503, 506, 499,&
       503, 133, 506,&
       499, 506, 37,&
       36, 485, 500,&
       485, 507, 500,&
       485, 127, 507,&
       500, 507, 132,&
       127, 508, 507,&
       508, 509, 507,&
       508, 134, 509,&
       507, 509, 132,&
       127, 484, 508,&
       484, 510, 508,&
       484, 7, 510,&
       508, 510, 134,&
       132, 509, 504,&
       509, 511, 504,&
       509, 134, 511,&
       504, 511, 38,&
       37, 506, 512,&
       506, 513, 512,&
       506, 133, 513,&
       512, 513, 135,&
       133, 514, 513,&
       514, 515, 513,&
       514, 136, 515,&
       513, 515, 135,&
       133, 505, 514,&
       505, 516, 514,&
       505, 38, 516,&
       514, 516, 136,&
       135, 515, 517,&
       515, 518, 517,&
       515, 136, 518,&
       517, 518, 1,&
       1, 518, 163,&
       518, 519, 163,&
       518, 136, 519,&
       163, 519, 43,&
       136, 520, 519,&
       520, 521, 519,&
       520, 137, 521,&
       519, 521, 43,&
       136, 516, 520,&
       516, 522, 520,&
       516, 38, 522,&
       520, 522, 137,&
       43, 521, 168,&
       521, 523, 168,&
       521, 137, 523,&
       168, 523, 13,&
       38, 524, 522,&
       524, 525, 522,&
       524, 138, 525,&
       522, 525, 137,&
       138, 526, 525,&
       526, 527, 525,&
       526, 139, 527,&
       525, 527, 137,&
       138, 528, 526,&
       528, 529, 526,&
       528, 39, 529,&
       526, 529, 139,&
       137, 527, 523,&
       527, 530, 523,&
       527, 139, 530,&
       523, 530, 13,&
       38, 511, 524,&
       511, 531, 524,&
       511, 134, 531,&
       524, 531, 138,&
       134, 532, 531,&
       532, 533, 531,&
       532, 140, 533,&
       531, 533, 138,&
       134, 510, 532,&
       510, 534, 532,&
       510, 7, 534,&
       532, 534, 140,&
       138, 533, 528,&
       533, 535, 528,&
       533, 140, 535,&
       528, 535, 39,&
       13, 530, 179,&
       530, 536, 179,&
       530, 139, 536,&
       179, 536, 48,&
       139, 537, 536,&
       537, 538, 536,&
       537, 141, 538,&
       536, 538, 48,&
       139, 529, 537,&
       529, 539, 537,&
       529, 39, 539,&
       537, 539, 141,&
       48, 538, 183,&
       538, 540, 183,&
       538, 141, 540,&
       183, 540, 2,&
       7, 466, 534,&
       466, 541, 534,&
       466, 122, 541,&
       534, 541, 140,&
       122, 542, 541,&
       542, 543, 541,&
       542, 142, 543,&
       541, 543, 140,&
       122, 464, 542,&
       464, 544, 542,&
       464, 34, 544,&
       542, 544, 142,&
       140, 543, 535,&
       543, 545, 535,&
       543, 142, 545,&
       535, 545, 39,&
       34, 546, 544,&
       546, 547, 544,&
       546, 143, 547,&
       544, 547, 142,&
       143, 548, 547,&
       548, 549, 547,&
       548, 144, 549,&
       547, 549, 142,&
       143, 550, 548,&
       550, 551, 548,&
       550, 24, 551,&
       548, 551, 144,&
       142, 549, 545,&
       549, 552, 545,&
       549, 144, 552,&
       545, 552, 39,&
       34, 459, 546,&
       459, 553, 546,&
       459, 120, 553,&
       546, 553, 143,&
       120, 554, 553,&
       554, 555, 553,&
       554, 84, 555,&
       553, 555, 143,&
       120, 458, 554,&
       458, 318, 554,&
       458, 11, 318,&
       554, 318, 84,&
       143, 555, 550,&
       555, 316, 550,&
       555, 84, 316,&
       550, 316, 24,&
       39, 552, 539,&
       552, 556, 539,&
       552, 144, 556,&
       539, 556, 141,&
       144, 557, 556,&
       557, 558, 556,&
       557, 82, 558,&
       556, 558, 141,&
       144, 551, 557,&
       551, 311, 557,&
       551, 24, 311,&
       557, 311, 82,&
       141, 558, 540,&
       558, 310, 540,&
       558, 82, 310,&
       540, 310, 2,&
       10, 559, 217,&
       559, 560, 217,&
       559, 145, 560,&
       217, 560, 57,&
       145, 561, 560,&
       561, 562, 560,&
       561, 146, 562,&
       560, 562, 57,&
       145, 563, 561,&
       563, 564, 561,&
       563, 40, 564,&
       561, 564, 146,&
       57, 562, 212,&
       562, 565, 212,&
       562, 146, 565,&
       212, 565, 16,&
       40, 566, 564,&
       566, 567, 564,&
       566, 147, 567,&
       564, 567, 146,&
       147, 568, 567,&
       568, 569, 567,&
       568, 148, 569,&
       567, 569, 146,&
       147, 570, 568,&
       570, 571, 568,&
       570, 37, 571,&
       568, 571, 148,&
       146, 569, 565,&
       569, 572, 565,&
       569, 148, 572,&
       565, 572, 16,&
       40, 573, 566,&
       573, 574, 566,&
       573, 149, 574,&
       566, 574, 147,&
       149, 575, 574,&
       575, 576, 574,&
       575, 130, 576,&
       574, 576, 147,&
       149, 577, 575,&
       577, 493, 575,&
       577, 12, 493,&
       575, 493, 130,&
       147, 576, 570,&
       576, 498, 570,&
       576, 130, 498,&
       570, 498, 37,&
       16, 572, 198,&
       572, 578, 198,&
       572, 148, 578,&
       198, 578, 52,&
       148, 579, 578,&
       579, 580, 578,&
       579, 135, 580,&
       578, 580, 52,&
       148, 571, 579,&
       571, 512, 579,&
       571, 37, 512,&
       579, 512, 135,&
       52, 580, 193,&
       580, 517, 193,&
       580, 135, 517,&
       193, 517, 1,&
       10, 581, 559,&
       581, 582, 559,&
       581, 150, 582,&
       559, 582, 145,&
       150, 583, 582,&
       583, 584, 582,&
       583, 151, 584,&
       582, 584, 145,&
       150, 585, 583,&
       585, 586, 583,&
       585, 41, 586,&
       583, 586, 151,&
       145, 584, 563,&
       584, 587, 563,&
       584, 151, 587,&
       563, 587, 40,&
       41, 588, 586,&
       588, 589, 586,&
       588, 152, 589,&
       586, 589, 151,&
       152, 590, 589,&
       590, 591, 589,&
       590, 153, 591,&
       589, 591, 151,&
       152, 592, 590,&
       592, 593, 590,&
       592, 42, 593,&
       590, 593, 153,&
       151, 591, 587,&
       591, 594, 587,&
       591, 153, 594,&
       587, 594, 40,&
       41, 595, 588,&
       595, 596, 588,&
       595, 154, 596,&
       588, 596, 152,&
       154, 597, 596,&
       597, 598, 596,&
       597, 155, 598,&
       596, 598, 152,&
       154, 599, 597,&
       599, 600, 597,&
       599, 3, 600,&
       597, 600, 155,&
       152, 598, 592,&
       598, 601, 592,&
       598, 155, 601,&
       592, 601, 42,&
       40, 594, 573,&
       594, 602, 573,&
       594, 153, 602,&
       573, 602, 149,&
       153, 603, 602,&
       603, 604, 602,&
       603, 156, 604,&
       602, 604, 149,&
       153, 593, 603,&
       593, 605, 603,&
       593, 42, 605,&
       603, 605, 156,&
       149, 604, 577,&
       604, 606, 577,&
       604, 156, 606,&
       577, 606, 12,&
       10, 219, 581,&
       219, 607, 581,&
       219, 59, 607,&
       581, 607, 150,&
       59, 608, 607,&
       608, 609, 607,&
       608, 157, 609,&
       607, 609, 150,&
       59, 224, 608,&
       224, 610, 608,&
       224, 18, 610,&
       608, 610, 157,&
       150, 609, 585,&
       609, 611, 585,&
       609, 157, 611,&
       585, 611, 41,&
       18, 612, 610,&
       612, 613, 610,&
       612, 158, 613,&
       610, 613, 157,&
       158, 614, 613,&
       614, 615, 613,&
       614, 159, 615,&
       613, 615, 157,&
       158, 616, 614,&
       616, 617, 614,&
       616, 28, 617,&
       614, 617, 159,&
       157, 615, 611,&
       615, 618, 611,&
       615, 159, 618,&
       611, 618, 41,&
       18, 238, 612,&
       238, 619, 612,&
       238, 64, 619,&
       612, 619, 158,&
       64, 620, 619,&
       620, 621, 619,&
       620, 97, 621,&
       619, 621, 158,&
       64, 243, 620,&
       243, 367, 620,&
       243, 6, 367,&
       620, 367, 97,&
       158, 621, 616,&
       621, 372, 616,&
       621, 97, 372,&
       616, 372, 28,&
       41, 618, 595,&
       618, 622, 595,&
       618, 159, 622,&
       595, 622, 154,&
       159, 623, 622,&
       623, 624, 622,&
       623, 102, 624,&
       622, 624, 154,&
       159, 617, 623,&
       617, 386, 623,&
       617, 28, 386,&
       623, 386, 102,&
       154, 624, 599,&
       624, 391, 599,&
       624, 102, 391,&
       599, 391, 3,&
       8, 467, 417,&
       467, 625, 417,&
       467, 123, 625,&
       417, 625, 109,&
       123, 626, 625,&
       626, 627, 625,&
       626, 160, 627,&
       625, 627, 109,&
       123, 472, 626,&
       472, 628, 626,&
       472, 35, 628,&
       626, 628, 160,&
       109, 627, 412,&
       627, 629, 412,&
       627, 160, 629,&
       412, 629, 30,&
       35, 630, 628,&
       630, 631, 628,&
       630, 161, 631,&
       628, 631, 160,&
       161, 632, 631,&
       632, 633, 631,&
       632, 162, 633,&
       631, 633, 160,&
       161, 634, 632,&
       634, 635, 632,&
       634, 42, 635,&
       632, 635, 162,&
       160, 633, 629,&
       633, 636, 629,&
       633, 162, 636,&
       629, 636, 30,&
       35, 486, 630,&
       486, 637, 630,&
       486, 128, 637,&
       630, 637, 161,&
       128, 638, 637,&
       638, 639, 637,&
       638, 156, 639,&
       637, 639, 161,&
       128, 491, 638,&
       491, 606, 638,&
       491, 12, 606,&
       638, 606, 156,&
       161, 639, 634,&
       639, 605, 634,&
       639, 156, 605,&
       634, 605, 42,&
       30, 636, 398,&
       636, 640, 398,&
       636, 162, 640,&
       398, 640, 104,&
       162, 641, 640,&
       641, 642, 640,&
       641, 155, 642,&
       640, 642, 104,&
       162, 635, 641,&
       635, 601, 641,&
       635, 42, 601,&
       641, 601, 155,&
       104, 642, 393,&
       642, 600, 393,&
       642, 155, 600,&
       393, 600, 3&
       /),(/3,1280/))

    ! fill the cylinder models
    vcyl = 0d0
    fcyl = 0

    ! lvl 0 -- hexagonal
    nvcyl(0) = 14
    vcyl(1:3,1:14,0) = reshape((/&
       -0.86603d0,  0.50000d0,  0.00000d0,&
       -0.86603d0, -0.50000d0,  0.00000d0,&
       -0.00000d0, -1.00000d0,  0.00000d0,&
        0.86603d0, -0.50000d0,  0.00000d0,&
        0.86603d0,  0.50000d0,  0.00000d0,&
        0.00000d0,  1.00000d0,  0.00000d0,&
       -0.86603d0,  0.50000d0,  1.00000d0,&
       -0.86603d0, -0.50000d0,  1.00000d0,&
       -0.00000d0, -1.00000d0,  1.00000d0,&
        0.86603d0, -0.50000d0,  1.00000d0,&
        0.86603d0,  0.50000d0,  1.00000d0,&
        0.00000d0,  1.00000d0,  1.00000d0,&
        0.00000d0,  0.00000d0,  0.00000d0,&
        0.00000d0,  0.00000d0,  1.00000d0/),(/3,14/))

    nfcyl(0) = 24
    fcyl(1:3,1:24,0) = reshape((/&
       13,  1,  2,&
       14,  7,  8,&
        1,  2,  7,&
        8,  7,  2,&
       13,  2,  3,&
       14,  8,  9,&
        2,  3,  8,&
        9,  8,  3,&
       13,  3,  4,&
       14,  9, 10,&
        3,  4,  9,&
       10,  9,  4,&
       13,  4,  5,&
       14, 10, 11,&
        4,  5, 10,&
       11, 10,  5,&
       13,  5,  6,&
       14, 11, 12,&
        5,  6, 11,&
       12, 11,  6,&
       13,  6,  1,&
       14, 12,  7,&
        6,  1, 12,&
        7, 12,  1/),(/3,24/))

    ! lvl 1 -- hexadecagonal
    nvcyl(1) = 34
    vcyl(1:3,1:34,1) = reshape((/&
       -0.38268,  0.92388,  0.00000,&
       -0.70711,  0.70711,  0.00000,&
       -0.92388,  0.38268,  0.00000,&
       -1.00000, -0.00000,  0.00000,&
       -0.92388, -0.38268,  0.00000,&
       -0.70711, -0.70711,  0.00000,&
       -0.38268, -0.92388,  0.00000,&
        0.00000, -1.00000,  0.00000,&
        0.38268, -0.92388,  0.00000,&
        0.70711, -0.70711,  0.00000,&
        0.92388, -0.38268,  0.00000,&
        1.00000,  0.00000,  0.00000,&
        0.92388,  0.38268,  0.00000,&
        0.70711,  0.70711,  0.00000,&
        0.38268,  0.92388,  0.00000,&
       -0.00000,  1.00000,  0.00000,&
       -0.38268,  0.92388,  1.00000,&
       -0.70711,  0.70711,  1.00000,&
       -0.92388,  0.38268,  1.00000,&
       -1.00000, -0.00000,  1.00000,&
       -0.92388, -0.38268,  1.00000,&
       -0.70711, -0.70711,  1.00000,&
       -0.38268, -0.92388,  1.00000,&
        0.00000, -1.00000,  1.00000,&
        0.38268, -0.92388,  1.00000,&
        0.70711, -0.70711,  1.00000,&
        0.92388, -0.38268,  1.00000,&
        1.00000,  0.00000,  1.00000,&
        0.92388,  0.38268,  1.00000,&
        0.70711,  0.70711,  1.00000,&
        0.38268,  0.92388,  1.00000,&
       -0.00000,  1.00000,  1.00000,&
        0.00000,  0.00000,  0.00000,&
        0.00000,  0.00000,  1.00000/),(/3,34/))

    nfcyl(1) = 64
    fcyl(1:3,1:64,1) = reshape((/&
       33,  1,  2,&
       34, 17, 18,&
        1,  2, 17,&
       18, 17,  2,&
       33,  2,  3,&
       34, 18, 19,&
        2,  3, 18,&
       19, 18,  3,&
       33,  3,  4,&
       34, 19, 20,&
        3,  4, 19,&
       20, 19,  4,&
       33,  4,  5,&
       34, 20, 21,&
        4,  5, 20,&
       21, 20,  5,&
       33,  5,  6,&
       34, 21, 22,&
        5,  6, 21,&
       22, 21,  6,&
       33,  6,  7,&
       34, 22, 23,&
        6,  7, 22,&
       23, 22,  7,&
       33,  7,  8,&
       34, 23, 24,&
        7,  8, 23,&
       24, 23,  8,&
       33,  8,  9,&
       34, 24, 25,&
        8,  9, 24,&
       25, 24,  9,&
       33,  9, 10,&
       34, 25, 26,&
        9, 10, 25,&
       26, 25, 10,&
       33, 10, 11,&
       34, 26, 27,&
       10, 11, 26,&
       27, 26, 11,&
       33, 11, 12,&
       34, 27, 28,&
       11, 12, 27,&
       28, 27, 12,&
       33, 12, 13,&
       34, 28, 29,&
       12, 13, 28,&
       29, 28, 13,&
       33, 13, 14,&
       34, 29, 30,&
       13, 14, 29,&
       30, 29, 14,&
       33, 14, 15,&
       34, 30, 31,&
       14, 15, 30,&
       31, 30, 15,&
       33, 15, 16,&
       34, 31, 32,&
       15, 16, 31,&
       32, 31, 16,&
       33, 16,  1,&
       34, 32, 17,&
       16,  1, 32,&
       17, 32,  1/),(/3,64/))

    ! nullify the graphics database
    isinit = .true.

  end subroutine graphics_init

  !> Open an obj file (and its mtl companion)
  subroutine obj_open(g)
    use tools_io, only: faterr, ferror, fopen_write
    type(grhandle), intent(inout) :: g

    integer :: idx
    character(len=:), allocatable :: filemtl, aux

    ! open the obj
    g%lu = fopen_write(g%file)

    ! name of the mtl
    filemtl = g%file
    idx = index(filemtl,'.',.true.)
    if (idx==0) call ferror("obj_open","could not parse file name",faterr)
    aux = trim(filemtl(1:idx-1)) // ".mtl"
    filemtl = aux

    ! open the mtl
    g%lumtl = fopen_write(filemtl)

    ! clear and initialize the mtl database
    g%nmtl = 0
    g%nball = 0
    g%nstick = 0
    g%nv = 0
    if (allocated(g%mtlrgb)) deallocate(g%mtlrgb)
    allocate(g%mtlrgb(3,10))

    ! write the obj header
    write (g%lu,'("# OBJ created by critic2")')
    write (g%lu,'("mtllib ",A)') trim(filemtl)

  end subroutine obj_open

  !> Close an obj file (and its mtl companion)
  subroutine obj_close(g)
    use tools_io, only: ferror, string, fclose
    type(grhandle), intent(inout) :: g

    integer :: i

    ! write the mtl
    do i = 1, g%nmtl
       write (g%lumtl,'("newmtl mat",A)') string(i)
       write (g%lumtl,'("Ns 96.078")')
       write (g%lumtl,'("Ka 0.0 0.0 0.0")')
       write (g%lumtl,'("Kd ",3(F12.5,X))') real(g%mtlrgb(:,i),8)/255d0
       write (g%lumtl,'("Ks 0.5 0.5 0.5")')
       write (g%lumtl,'("Ni 1.0")')
       write (g%lumtl,'("illum 2")')
       write (g%lumtl,*)
    end do

    ! clear the mtl database
    g%nmtl = 0
    g%nball = 0
    g%nstick = 0
    g%nv = 0
    deallocate(g%mtlrgb)

    ! close both files
    call fclose(g%lu)
    call fclose(g%lumtl)

  end subroutine obj_close

  !> Write a ball to the obj file
  subroutine obj_ball(g,x,rgb,r)
    use tools_io, only: ferror, string
    type(grhandle), intent(inout) :: g
    real*8, intent(in) :: x(3)
    integer, intent(in) :: rgb(3)
    real*8, intent(in) :: r

    integer :: imtl, i, lvl

    ! ball detail
    if (r > 0.5) then
       lvl = 4
    elseif (r > 0.2) then
       lvl = 3
    else
       lvl = 2
    endif

    ! write the ball to the obj
    g%nball = g%nball + 1
    write (g%lu,'("o ball_",A)') string(g%nball)
    write (g%lu,'("s on")')
    imtl = register_texture(g,rgb)
    write (g%lu,'("usemtl mat",A)') string(imtl)
    do i = 1, nvsph(lvl)
       write (g%lu,'("v ",3(F20.12,X))') x + r * vsph(:,i,lvl)
    end do
    do i = 1, nfsph(lvl)
       write (g%lu,'("f ",3(I10,X))') g%nv + fsph(:,i,lvl)
    end do
    g%nv = g%nv + nvsph(lvl)

  end subroutine obj_ball

  !> Write a polygon to the obj file. The coordinates are in array x
  !> (Cartesian), and are assumed to be in order.
  subroutine obj_polygon(g,x,rgb)
    use tools_io, only: ferror, string
    type(grhandle), intent(inout) :: g
    real*8, intent(in) :: x(:,:)
    integer, intent(in) :: rgb(3)

    integer :: imtl, i, n
    character(len=:), allocatable :: str, aux

    ! write the face to the obj
    n = size(x,2)
    g%npoly = g%npoly + 1
    write (g%lu,'("o face_",A)') string(g%npoly)
    write (g%lu,'("s on")')
    imtl = register_texture(g,rgb)
    write (g%lu,'("usemtl mat",A)') string(imtl)
    do i = 1, n
       write (g%lu,'("v ",3(F20.12,X))') x(:,i)
    end do
    str = ""
    do i = 1, n
       aux = str // string(g%nv+i) // " "
       str = aux
    end do
    write (g%lu,'("f ",A)') str
    g%nv = g%nv + n

  end subroutine obj_polygon

  !> Write a stick to the obj file
  subroutine obj_stick(g,x1,x2,rgb,r)
    use tools_io, only: ferror, string
    use tools_math, only: cross
    type(grhandle), intent(inout) :: g
    real*8, intent(in) :: x1(3), x2(3)
    integer, intent(in) :: rgb(3)
    real*8, intent(in) :: r

    integer :: imtl, i, lvl
    real*8 :: dist, xd(3), v1(3), v2(3)

    ! stick detail
    if (r > 0.2) then
       lvl = 1
    else
       lvl = 0
    endif

    ! kill degenerate sticks
    xd = x2 - x1
    dist = norm2(xd)
    if (dist < 1d-6) return

    ! local coordinates of the tube
    if (abs(xd(1)) > 1d-6) then
       v1 = (/-xd(2)/xd(1), 1d0, 0d0/)
    elseif (abs(xd(2)) > 1d-6) then
       v1 = (/0d0, -xd(3)/xd(2), 1d0/)
    elseif (abs(xd(3)) > 1d-6) then
       v1 = (/1d0, 0d0, -xd(1)/xd(3)/)
    else
       return
    endif
    v2 = cross(xd,v1)
    v1 = v1 / norm2(v1) * r
    v2 = v2 / norm2(v2) * r

    ! write the stick to the obj
    g%nstick = g%nstick + 1
    write (g%lu,'("o stick_",A)') string(g%nstick)
    write (g%lu,'("s on")')
    imtl = register_texture(g,rgb)
    write (g%lu,'("usemtl mat",A)') string(imtl)
    do i = 1, nvcyl(lvl)
       write (g%lu,'("v ",3(F20.12,X))') x1+vcyl(1,i,lvl)*v1+&
          vcyl(2,i,lvl)*v2+vcyl(3,i,lvl)*xd
    end do
    do i = 1, nfcyl(lvl)
       write (g%lu,'("f ",3(I10,X))') g%nv + fcyl(:,i,lvl)
    end do
    g%nv = g%nv + nvcyl(lvl)

  end subroutine obj_stick

  !> Write a surface to the obj file
  subroutine obj_surf(g,srf,fsurf)
    use surface, only: minisurf
    use tools_io, only: ferror, faterr, string
    use param, only: pi
    type(grhandle), intent(inout) :: g
    type(minisurf), intent(in) :: srf
    real*8, intent(in), optional :: fsurf(:)

    integer, parameter :: rgb_default(3) = (/128,128,128/)

    integer :: i, j, imtl
    real*8 :: x(3), maxf, minf, xrgb(3), z

    if (srf%isinit <= 1) &
       call ferror ('obj_surf','No face information in minisurf',faterr)

    ! limits of the color scale
    if (present(fsurf)) then
       if (size(fsurf) == 3) then
          xrgb = fsurf
       else
          maxf = maxval(fsurf)
          minf = minval(fsurf)
       endif
    endif

    ! write the surface to the obj
    g%nsurf = g%nsurf + 1
    write (g%lu,'("o surf_",A)') string(g%nsurf)
    write (g%lu,'("s on")')
    imtl = register_texture(g,rgb_default)
    write (g%lu,'("usemtl mat",A)') string(imtl)
    do i = 1, srf%nv
       x = srf%n + (/ srf%r(i) * sin(srf%th(i)) * cos(srf%ph(i)),&
           srf%r(i) * sin(srf%th(i)) * sin(srf%ph(i)),&
           srf%r(i) * cos(srf%th(i)) /)
       if (present(fsurf)) then
          if (size(fsurf) /= 3) then
             z = (fsurf(i) - minf) / (maxf - minf)
             xrgb(1) = sqrt(z)
             xrgb(2) = z**3
             xrgb(3) = sin(2*z*pi)
          end if
          write (g%lu,'("v ",3(E20.12,X),3(F8.5,X))') x, xrgb
       else
          write (g%lu,'("v ",3(E20.12,X))') x
       endif
    end do
    do i = 1, srf%nf
       write (g%lu,'("f ",999(I10,X))') &
          (g%nv+srf%f(i)%v(j),j=1,srf%f(i)%nv)
    end do
    g%nv = g%nv + srf%nv

  end subroutine obj_surf

  !> Write a surface from its triangulation to an OBJ file.
  subroutine obj_triangulation(g,nv,xv,nf,if,xrho)
    use tools_io, only: string
    use param, only: pi
    type(grhandle), intent(inout) :: g
    integer, intent(in) :: nv, nf
    real*8, intent(in) :: xv(3,nv)
    integer, intent(in) :: if(3,nf)
    real*8, intent(in), optional :: xrho(nv)

    integer :: i, j, imtl
    real*8 :: maxf, minf, xrgb(3), z

    integer, parameter :: rgb_default(3) = (/128,128,128/)

    ! limits of the color scale
    if (present(xrho)) then
       maxf = maxval(xrho)
       minf = minval(xrho)
    endif

    ! write the surface to the obj
    g%nsurf = g%nsurf + 1
    write (g%lu,'("o surf_",A)') string(g%nsurf)
    write (g%lu,'("s on")')
    imtl = register_texture(g,rgb_default)
    write (g%lu,'("usemtl mat",A)') string(imtl)
    do i = 1, nv
       if (present(xrho)) then
          z = (xrho(i) - minf) / (maxf - minf)
          xrgb(1) = sqrt(z)
          xrgb(2) = z**3
          xrgb(3) = sin(2*z*pi)
          write (g%lu,'("v ",3(E20.12,X),3(F8.5,X))') xv(:,i), xrgb
       else
          write (g%lu,'("v ",3(E20.12,X))') xv(:,i)
       end if
    end do
    do i = 1, nf
       write (g%lu,'("f ",999(I10,X))') (if(j,i),j=1,3)
    end do
    g%nv = g%nv + nv

  end subroutine obj_triangulation

  !> Register a texture using the color triplet.
  function register_texture(g,rgb) result(imtl)
    use types, only: realloc
    type(grhandle), intent(inout) :: g
    integer, intent(in) :: rgb(3)
    integer :: imtl

    integer :: i

    do i = 1, g%nmtl
       if (all(g%mtlrgb(:,i)-rgb == 0)) then
          imtl = i
          return
       end if
    end do
    g%nmtl = g%nmtl + 1
    if (g%nmtl > size(g%mtlrgb,2)) call realloc(g%mtlrgb,3,2*g%nmtl)
    g%mtlrgb(:,g%nmtl) = rgb
    imtl = g%nmtl

  end function register_texture

  !> Open a ply file
  subroutine ply_open(g)
    use tools_io, only: ferror, fopen_scratch
    type(grhandle), intent(inout) :: g

    ! open the temporary ply file
    g%lu = fopen_scratch("formatted")

    ! clear and initialize the database
    g%nv = 0
    g%nf = 0

  end subroutine ply_open

  !> Close a ply file
  subroutine ply_close(g)
    use tools_io, only: ferror, getline_raw, fopen_write, string, fclose
    type(grhandle), intent(inout) :: g

    integer :: lu
    character(len=:), allocatable :: file, line
    logical :: ok

    ! get the temporary file name from the first line and open
    rewind(g%lu)
    lu = fopen_write(g%file)

    ! write the header
    write (lu,'("ply ")')
    write (lu,'("format ascii 1.0")')
    write (lu,'("comment PLY created by critic2")')
    write (lu,'("element vertex ",A)') string(g%nv)
    write (lu,'("property float x")')
    write (lu,'("property float y")')
    write (lu,'("property float z")')
    write (lu,'("property uchar red")')
    write (lu,'("property uchar green")')
    write (lu,'("property uchar blue")')
    write (lu,'("property uchar alpha")')
    write (lu,'("element face ",A)') string(g%nf)
    write (lu,'("property list uchar int vertex_indices")')
    write (lu,'("end_header")')

    ! transfer the vertices from the scratch file over to the ply file
    do while(getline_raw(g%lu,line))
       if (line(1:1) == "v") then
          write (lu,'(A)') line(2:)
       endif
    end do

    ! transfer the faces
    rewind(g%lu)
    ok = getline_raw(g%lu,file,.true.)
    do while(getline_raw(g%lu,line))
       if (line(1:1) == "f") then
          write (lu,'(A)') line(2:)
       endif
    end do

    ! close both
    call fclose(lu)
    call fclose(g%lu)

    ! clear the database
    g%nv = 0
    g%nf = 0

  end subroutine ply_close

  !> Write a ball to the ply file
  subroutine ply_ball(g,x,rgb,r)
    use tools_io, only: ferror, string
    type(grhandle), intent(inout) :: g
    real*8, intent(in) :: x(3)
    integer, intent(in) :: rgb(3)
    real*8, intent(in) :: r

    integer :: i, lvl, iff(3)

    ! ball detail
    if (r > 0.5) then
       lvl = 4
    elseif (r > 0.2) then
       lvl = 3
    else
       lvl = 2
    endif

    ! write the ball to the ply
    do i = 1, nvsph(lvl)
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') x + r * vsph(:,i,lvl), &
          string(rgb(1)), string(rgb(2)), string(rgb(3))
    end do
    do i = 1, nfsph(lvl)
       iff = g%nv + fsph(:,i,lvl) - 1
       write (g%lu,'("f3 ",3(A,X))') string(iff(1)), string(iff(2)), string(iff(3))
    end do
    g%nv = g%nv + nvsph(lvl)
    g%nf = g%nf + nfsph(lvl)

  end subroutine ply_ball

  !> Write a polygon to the ply file. The coordinates are in array x
  !> (Cartesian), and are assumed to be in order.
  subroutine ply_polygon(g,x,rgb)
    use tools_io, only: ferror, string
    type(grhandle), intent(inout) :: g
    real*8, intent(in) :: x(:,:)
    integer, intent(in) :: rgb(3)

    integer :: i, i1, n
    real*8 :: xcm(3)

    ! center of the face
    n = size(x,2)
    xcm = 0d0
    do i = 1, n
       xcm = xcm + x(:,i)
    end do
    xcm = xcm / n

    ! write the face to the obj
    do i = 1, n
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') x(:,i), &
          string(rgb(1)), string(rgb(2)), string(rgb(3))
    end do
    write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') xcm, &
       string(rgb(1)), string(rgb(2)), string(rgb(3))

    do i = 1, n
       i1 = mod(i,n) + 1
       write (g%lu,'("f3 ",3(A,X))') string(g%nv+i-1), string(g%nv+i1-1), string(g%nv+n)
    end do
    g%nv = g%nv + n + 1
    g%nf = g%nf + n

  end subroutine ply_polygon

  !> Write a stick to the ply file
  subroutine ply_stick(g,x1,x2,rgb,r)
    use tools_io, only: ferror, string
    use tools_math, only: cross
    type(grhandle), intent(inout) :: g
    real*8, intent(in) :: x1(3), x2(3)
    integer, intent(in) :: rgb(3)
    real*8, intent(in) :: r

    integer :: i, lvl, iff(3)
    real*8 :: dist, xd(3), v1(3), v2(3)

    ! stick detail
    if (r > 0.2) then
       lvl = 1
    else
       lvl = 0
    endif

    ! kill degenerate sticks
    xd = x2 - x1
    dist = norm2(xd)
    if (dist < 1d-6) return

    ! local coordinates of the tube
    if (abs(xd(1)) > 1d-6) then
       v1 = (/-xd(2)/xd(1), 1d0, 0d0/)
    elseif (abs(xd(2)) > 1d-6) then
       v1 = (/0d0, -xd(3)/xd(2), 1d0/)
    elseif (abs(xd(3)) > 1d-6) then
       v1 = (/1d0, 0d0, -xd(1)/xd(3)/)
    else
       return
    endif
    v2 = cross(xd,v1)
    v1 = v1 / norm2(v1) * r
    v2 = v2 / norm2(v2) * r

    ! write the stick to the ply
    do i = 1, nvcyl(lvl)
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') &
          x1+vcyl(1,i,lvl)*v1+vcyl(2,i,lvl)*v2+vcyl(3,i,lvl)*xd,&
          string(rgb(1)), string(rgb(2)), string(rgb(3))
    end do
    do i = 1, nfcyl(lvl)
       iff = g%nv + fcyl(:,i,lvl) - 1
       write (g%lu,'("f3 ",3(A,X))') string(iff(1)), string(iff(2)), string(iff(3))
    end do
    g%nv = g%nv + nvcyl(lvl)
    g%nf = g%nf + nfcyl(lvl)

  end subroutine ply_stick

  !> Write a surface to the ply file
  subroutine ply_surf(g,srf,fsurf)
    use surface, only: minisurf
    use tools_io, only: ferror, faterr, string
    use param, only: pi
    type(grhandle), intent(inout) :: g
    type(minisurf), intent(in) :: srf
    real*8, intent(in), optional :: fsurf(:)

    integer, parameter :: rgb_default(3) = (/128,128,128/)

    integer :: i, j, rgb(3)
    real*8 :: x(3), maxf, minf, xrgb(3), z

    if (srf%isinit <= 1) &
       call ferror ('ply_surf','No face information in minisurf',faterr)

    ! limits of the color scale
    rgb = rgb_default
    if (present(fsurf)) then
       if (size(fsurf) /= 3) then
          maxf = maxval(fsurf)
          minf = minval(fsurf)
       else
          rgb = nint(fsurf * 255)
       end if
    endif

    do i = 1, srf%nv
       x = srf%n + (/ srf%r(i) * sin(srf%th(i)) * cos(srf%ph(i)),&
           srf%r(i) * sin(srf%th(i)) * sin(srf%ph(i)),&
           srf%r(i) * cos(srf%th(i)) /)
       if (present(fsurf)) then
          if (size(fsurf) > 3) then
             z = (fsurf(i) - minf) / (maxf - minf)
             xrgb(1) = sqrt(z)
             xrgb(2) = z**3
             xrgb(3) = sin(2*z*pi)
             rgb = nint(xrgb * 255)
          end if
       endif
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') x,&
          string(rgb(1)), string(rgb(2)), string(rgb(3))
    end do
    do i = 1, srf%nf
       write (g%lu,'("f",999(A,X))') string(srf%f(i)%nv),&
          (string(g%nv+srf%f(i)%v(j)-1),j=1,srf%f(i)%nv)
    end do
    g%nv = g%nv + srf%nv
    g%nf = g%nf + srf%nf

  end subroutine ply_surf

  !> Write a surface from its triangulation to a PLY file.
  subroutine ply_triangulation(g,nv,xv,nf,if,xrho)
    use tools_io, only: string
    use param, only: pi
    type(grhandle), intent(inout) :: g
    integer, intent(in) :: nv, nf
    real*8, intent(in) :: xv(3,nv)
    integer, intent(in) :: if(3,nf)
    real*8, intent(in), optional :: xrho(nv)

    real*8 :: maxf, minf, xrgb(3), z
    integer :: i, j, rgb(3)

    integer, parameter :: rgb_default(3) = (/128,128,128/)

    ! limits of the color scale
    if (present(xrho)) then
       maxf = maxval(xrho)
       minf = minval(xrho)
    endif

    rgb = rgb_default
    do i = 1, nv
       if (present(xrho)) then
          z = (xrho(i) - minf) / (maxf - minf)
          xrgb(1) = sqrt(z)
          xrgb(2) = z**3
          xrgb(3) = sin(2*z*pi)
          rgb = nint(xrgb * 255)
       end if
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') xv(:,i), (string(rgb(j)),j=1,3)
    end do
    do i = 1, nf
       write (g%lu,'("f",999(A,X))') "3", (string(g%nv+if(j,i)-1),j=1,3)
    end do
    g%nv = g%nv + nv
    g%nf = g%nf + nf

  end subroutine ply_triangulation

  !> Open an off file
  subroutine off_open(g)
    use tools_io, only: ferror, fopen_scratch
    type(grhandle), intent(inout) :: g

    ! open the temporary off file
    g%lu = fopen_scratch("formatted")

    ! clear and initialize the database
    g%nv = 0
    g%nf = 0

  end subroutine off_open

  !> Close a off file
  subroutine off_close(g)
    use tools_io, only: ferror, getline_raw, string, fopen_write, fclose
    type(grhandle), intent(inout) :: g

    integer :: lu
    character(len=:), allocatable :: file, line
    logical :: ok

    ! get the temporary file name from the first line and open
    rewind(g%lu)
    lu = fopen_write(g%file)

    ! write the header
    write (lu,'("COFF")')
    write (lu,'(3(A,X))') string(g%nv), string(g%nf), string(g%nv+g%nf-2)

    ! transfer the vertices from the scratch file over to the off file
    do while(getline_raw(g%lu,line))
       if (line(1:1) == "v") then
          write (lu,'(A)') line(2:)
       endif
    end do

    ! transfer the faces
    rewind(g%lu)
    ok = getline_raw(g%lu,file,.true.)
    do while(getline_raw(g%lu,line))
       if (line(1:1) == "f") then
          write (lu,'(A)') line(2:)
       endif
    end do

    ! close both
    call fclose(lu)
    call fclose(g%lu)

    ! clear the database
    g%nv = 0
    g%nf = 0

  end subroutine off_close

  !> Write a ball to the off file
  subroutine off_ball(g,x,rgb,r)
    use tools_io, only: ferror, string
    type(grhandle), intent(inout) :: g
    real*8, intent(in) :: x(3)
    integer, intent(in) :: rgb(3)
    real*8, intent(in) :: r

    integer :: i, lvl, iff(3)
    real*8 :: xrgb(3)

    ! ball detail
    if (r > 0.5) then
       lvl = 4
    elseif (r > 0.2) then
       lvl = 3
    else
       lvl = 2
    endif

    ! write the ball to the off
    do i = 1, nvsph(lvl)
       xrgb = real(rgb,8) / 255d0
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0.0")') x + r * vsph(:,i,lvl), &
          string(xrgb(1),"g"), string(xrgb(2),"g"), string(xrgb(3),"g")
    end do
    do i = 1, nfsph(lvl)
       iff = g%nv + fsph(:,i,lvl) - 1
       write (g%lu,'("f3 ",3(A,X))') string(iff(1)), string(iff(2)), string(iff(3))
    end do
    g%nv = g%nv + nvsph(lvl)
    g%nf = g%nf + nfsph(lvl)

  end subroutine off_ball

  !> Write a polygon to the off file. The coordinates are in array x
  !> (Cartesian), and are assumed to be in order.
  subroutine off_polygon(g,x,rgb)
    use tools_io, only: ferror, string
    type(grhandle), intent(inout) :: g
    real*8, intent(in) :: x(:,:)
    integer, intent(in) :: rgb(3)

    integer :: i, i1, n
    real*8 :: xcm(3)

    ! center of the face
    n = size(x,2)
    xcm = 0d0
    do i = 1, n
       xcm = xcm + x(:,i)
    end do
    xcm = xcm / n

    ! write the face to the obj
    do i = 1, n
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') x(:,i), &
          string(rgb(1)), string(rgb(2)), string(rgb(3))
    end do
    write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') xcm, &
       string(rgb(1)), string(rgb(2)), string(rgb(3))

    do i = 1, n
       i1 = mod(i,n) + 1
       write (g%lu,'("f3 ",3(A,X))') string(g%nv+i-1), string(g%nv+i1-1), string(g%nv+n)
    end do
    g%nv = g%nv + n + 1
    g%nf = g%nf + n

  end subroutine off_polygon

  !> Write a stick to the off file
  subroutine off_stick(g,x1,x2,rgb,r)
    use tools_io, only: ferror, string
    use tools_math, only: cross
    type(grhandle), intent(inout) :: g
    real*8, intent(in) :: x1(3), x2(3)
    integer, intent(in) :: rgb(3)
    real*8, intent(in) :: r

    integer :: i, lvl, iff(3)
    real*8 :: dist, xd(3), v1(3), v2(3)
    real*8 :: xrgb(3)

    ! stick detail
    if (r > 0.2) then
       lvl = 1
    else
       lvl = 0
    endif

    ! kill degenerate sticks
    xd = x2 - x1
    dist = norm2(xd)
    if (dist < 1d-6) return

    ! local coordinates of the tube
    if (abs(xd(1)) > 1d-6) then
       v1 = (/-xd(2)/xd(1), 1d0, 0d0/)
    elseif (abs(xd(2)) > 1d-6) then
       v1 = (/0d0, -xd(3)/xd(2), 1d0/)
    elseif (abs(xd(3)) > 1d-6) then
       v1 = (/1d0, 0d0, -xd(1)/xd(3)/)
    else
       return
    endif
    v2 = cross(xd,v1)
    v1 = v1 / norm2(v1) * r
    v2 = v2 / norm2(v2) * r

    ! write the stick to the off
    do i = 1, nvcyl(lvl)
       xrgb = real(rgb,8) / 255d0
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') &
          x1+vcyl(1,i,lvl)*v1+vcyl(2,i,lvl)*v2+vcyl(3,i,lvl)*xd,&
          string(xrgb(1),"g"), string(xrgb(2),"g"), string(xrgb(3),"g")
    end do
    do i = 1, nfcyl(lvl)
       iff = g%nv + fcyl(:,i,lvl) - 1
       write (g%lu,'("f3 ",3(A,X))') string(iff(1)), string(iff(2)), string(iff(3))
    end do
    g%nv = g%nv + nvcyl(lvl)
    g%nf = g%nf + nfcyl(lvl)

  end subroutine off_stick

  !> Write a surface to the off file
  subroutine off_surf(g,srf,fsurf)
    use surface, only: minisurf
    use tools_io, only: faterr, ferror, string
    use param, only: pi
    type(grhandle), intent(inout) :: g
    type(minisurf), intent(in) :: srf
    real*8, intent(in), optional :: fsurf(:)

    integer, parameter :: rgb_default(3) = (/128,128,128/)

    integer :: i, j, rgb(3)
    real*8 :: x(3), z
    real*8 :: xrgb(3), maxf, minf

    if (srf%isinit <= 1) &
       call ferror ('off_surf','No face information in minisurf',faterr)

    ! limits of the color scale
    minf = 0d0
    rgb = rgb_default
    xrgb = real(rgb,8) / 255d0
    if (present(fsurf)) then
       if (size(fsurf) /= 3) then
          maxf = maxval(fsurf)
          minf = minval(fsurf)
       else
          xrgb = fsurf
       endif
    endif

    do i = 1, srf%nv
       x = srf%n + (/ srf%r(i) * sin(srf%th(i)) * cos(srf%ph(i)),&
           srf%r(i) * sin(srf%th(i)) * sin(srf%ph(i)),&
           srf%r(i) * cos(srf%th(i)) /)
       if (present(fsurf)) then
          if (size(fsurf) /= 3) then
             z = (fsurf(i) - minf) / (maxf - minf)
             xrgb(1) = sqrt(z)
             xrgb(2) = z**3
             xrgb(3) = sin(2*z*pi)
          endif
       endif
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') x,&
          string(xrgb(1),"g"), string(xrgb(2),"g"), string(xrgb(3),"g")
    end do
    do i = 1, srf%nf
       write (g%lu,'("f",999(A,X))') string(srf%f(i)%nv),&
          (string(g%nv+srf%f(i)%v(j)-1),j=1,srf%f(i)%nv)
    end do
    g%nv = g%nv + srf%nv
    g%nf = g%nf + srf%nf

  end subroutine off_surf

  !> Write a surface from its triangulation to a OFF file.
  subroutine off_triangulation(g,nv,xv,nf,if,xrho)
    use tools_io, only: string
    use param, only: pi
    type(grhandle), intent(inout) :: g
    integer, intent(in) :: nv, nf
    real*8, intent(in) :: xv(3,nv)
    integer, intent(in) :: if(3,nf)
    real*8, intent(in), optional :: xrho(nv)

    integer :: i, j
    real*8 :: maxf, minf, xrgb(3), z

    integer, parameter :: rgb_default(3) = (/128,128,128/)

    ! limits of the color scale
    if (present(xrho)) then
       maxf = maxval(xrho)
       minf = minval(xrho)
    endif

    xrgb = real(rgb_default,8) / 255d0
    do i = 1, nv
       if (present(xrho)) then
          z = (xrho(i) - minf) / (maxf - minf)
          xrgb(1) = sqrt(z)
          xrgb(2) = z**3
          xrgb(3) = sin(2*z*pi)
       end if
       write (g%lu,'("v",3(F20.12,X),3(A,X),"0")') xv(:,i), (string(xrgb(j),"g"),j=1,3)
    end do
    do i = 1, nf
       write (g%lu,'("f",999(A,X))') "3", (string(g%nv+if(j,i)-1),j=1,3)
    end do
    g%nv = g%nv + nv
    g%nf = g%nf + nf

  end subroutine off_triangulation

end submodule proc
